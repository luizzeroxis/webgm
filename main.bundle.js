"use strict";(self.webpackChunkwebgm=self.webpackChunkwebgm||[]).push([[179],{442:(t,e,r)=>{class i{constructor(){this.resources={},this.counter={},i.getTypes().forEach((t=>{this.resources[t.name]=[],this.counter[t.name]=0})),this.gameInformation=new A,this.globalGameSettings=new x,this.extensionPackages=new k,this.lastId=1e5}static getTypes(){return[s,a,n,c,u,l,_,h,v]}}class s{constructor(){this.id=null,this.name=null,this.images=[],this.originx=0,this.originy=0,this.separateCollisionMasks=!1,this.alphaTolerance=0,this.boundingBox="automatic",this.bbLeft=31,this.bbTop=31,this.bbRight=0,this.bbBottom=0,this.shape="precise"}static getName(){return"sprite"}static getScreenName(){return"Sprite"}static getScreenGroupName(){return"Sprites"}}class a{constructor(){this.id=null,this.name=null,this.sound=null,this.volume=1}static getName(){return"sound"}static getScreenName(){return"Sound"}static getScreenGroupName(){return"Sounds"}}class n{constructor(){this.id=null,this.name=null,this.image=null,this.useAsTileSet=!1,this.tileWidth=16,this.tileHeight=16,this.horizontalOffset=0,this.verticalOffset=0,this.horizontalSep=0,this.verticalSep=0}static getName(){return"background"}static getScreenName(){return"Background"}static getScreenGroupName(){return"Backgrounds"}}class c{constructor(){this.id=null,this.name=null,this.points=[],this.backgroundRoomIndex=-1,this.connectionKind="lines",this.closed=!0,this.precision=4}static getName(){return"path"}static getScreenName(){return"Path"}static getScreenGroupName(){return"Paths"}}class o{constructor(t=0,e=0,r=100){this.x=t,this.y=e,this.sp=r}}class u{constructor(){this.id=null,this.name=null,this.code=""}static getName(){return"script"}static getScreenName(){return"Script"}static getScreenGroupName(){return"Scripts"}}class l{constructor(){this.id=null,this.name=null,this.font="Arial",this.size=12,this.bold=!1,this.italic=!1}static getName(){return"font"}static getScreenName(){return"Font"}static getScreenGroupName(){return"Fonts"}}class _{constructor(){this.id=null,this.name=null,this.moments=[]}static getName(){return"timeline"}static getScreenName(){return"Time Line"}static getScreenGroupName(){return"Time Lines"}}class d{constructor(t){this.step=t,this.actions=[]}}class h{constructor(){this.id=null,this.name=null,this.sprite_index=-1,this.visible=!0,this.solid=!1,this.depth=0,this.persistent=!1,this.parent=null,this.mask=null,this.events=[]}static getName(){return"object"}static getScreenName(){return"Object"}static getScreenGroupName(){return"Objects"}}class p{constructor(t,e){this.type=t,this.subtype=e,this.actions=[]}getNameId(){return JSON.stringify({type:this.type,subtype:this.subtype})}getName(){return this.type+" "+this.subtype}}class m{constructor(){this.typeLibrary=null,this.typeId=null,this.typeKind=null,this.typeExecution=null,this.typeExecutionFunction=null,this.typeExecutionCode=null,this.typeIsQuestion=null,this.args=[],this.appliesTo=-1,this.relative=!1,this.not=!1}}class g{constructor(t,e){this.kind=t,this.value=e}}class v{constructor(){this.id=null,this.name=null,this.instances=[],this.caption="",this.width=640,this.height=480,this.speed=30,this.persistent=!1,this.creationCode="",this.tiles=[],this.drawBackgroundColor=!0,this.backgroundColor="#c0c0c0",this.backgrounds=[],this.enableViews=!1,this.views=[]}static getName(){return"room"}static getScreenName(){return"Room"}static getScreenGroupName(){return"Rooms"}}class f{constructor(t,e,r){this.x=t,this.y=e,this.object_index=r}}class y{constructor(t,e,r,i,s,a,n,c){this.backgroundIndex=t,this.x=e,this.y=r,this.backgroundX=i,this.backgroundY=s,this.backgroundW=a,this.backgroundH=n,this.depth=c}}class w{constructor(){this.visibleAtStart=!1,this.isForeground=!1,this.backgroundIndex=-1,this.tileHorizontally=!0,this.tileVertically=!0,this.x=0,this.y=0,this.stretch=!1,this.horizontalSpeed=0,this.verticalSpeed=0}}class b{constructor(){this.visibleAtStart=!1,this.viewX=0,this.viewY=0,this.viewW=640,this.viewH=480,this.portX=0,this.portY=0,this.portW=640,this.portH=480,this.objectFollowIndex=-1,this.objectFollowHorizontalBorder=32,this.objectFollowVerticalBorder=32,this.objectFollowHorizontalSpeed=-1,this.objectFollowVerticalSpeed=-1}}class A{constructor(){this.text="",this.separateWindow=!1,this.windowCaption="Game Information",this.left=-1,this.right=-1,this.width=600,this.height=400,this.showBorderAndCaption=!0,this.allowResize=!0,this.alwaysOnTop=!1,this.stopGame=!0}}class x{constructor(){this.startInFullScreen=!1,this.colorOutsideRoom="#000000",this.displayCursor=!0,this.keyEscEndsGame=!0,this.keyF1ShowsGameInformation=!0,this.ketF4SwitchesFullScreen=!0,this.keyF5SavesF6Loads=!0,this.keyF9Screenshots=!0,this.versionMajor=1,this.versionMinor=0,this.versionRelease=0,this.versionBuild=0,this.company="",this.product="",this.copyright="",this.description="",this.displayErrors=!0,this.abortOnError=!1,this.unitializedVarsAre0=!1,this.author="",this.version="100",this.information=""}}class k{constructor(){}}class E{constructor(){this.listeners={}}listen(t){for(var e in t)this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t[e]);return t}stopListening(t){for(var e in t){var r=this.listeners[e].findIndex((r=>r==t[e]));this.listener[e].splice(r,1)}}speak(t,...e){if(this.listeners[t])for(var r in this.listeners[t])this.listeners[t][r](...e)}}class I{static getList(){return[{name:"move",items:[{id:101,description:"Move Fixed",getListText:t=>"Start moving in a direction",getHintText:t=>S.textApplyTo(t)+"start moving in directions "+S.textArg(t,0)+" with speed set "+S.textRelative(t)+"to "+S.textArg(t,1),kind:"normal",execution:"function",executionFunction:"action_move",interfaceKind:"arrows",isQuestion:!1,hasApplyTo:!0,hasRelative:!0},{id:112,description:"Wrap Screen",getListText:t=>"Wrap @0 when outside",getHintText:t=>"@wwrap @0 when an instance moves outside the room",kind:"normal",execution:"function",executionFunction:"action_wrap",interfaceKind:"normal",isQuestion:!1,hasApplyTo:!0,hasRelative:!1,args:[{name:"direction:",kind:"menu",menu:["horizontal","vertical","in both directions"],default:0}]}]},{name:"main2",items:[{id:321,description:"Display Message",getListText:t=>"Display a message",getHintText:t=>"display message: "+S.textArg(t,0),kind:"normal",execution:"function",executionFunction:"action_message",interfaceKind:"normal",isQuestion:!1,hasApplyTo:!1,hasRelative:!1,args:[{name:"message:",kind:"both",default:""}]}]},{name:"control",items:[{id:421,description:"Else",getListText:t=>"Else",getHintText:t=>"else",kind:"else"},{id:422,description:"Start Block",getListText:t=>"Start of a block",getHintText:t=>"start of a block",kind:"begin"},{id:423,description:"Repeat",getListText:t=>"Repeat "+S.textArg(t,0)+" times",getHintText:t=>"repeat next action (block) "+S.textArg(t,0)+" times",kind:"repeat"},{id:424,description:"End Block",getListText:t=>"End of a block",getHintText:t=>"end of a block",kind:"end"},{id:425,description:"Exit Event",getListText:t=>"Exit this event",getHintText:t=>"exit this event",kind:"exit"},{id:603,description:"Execute Code",getListText:t=>"Execute a piece of code",getHintText:t=>S.textApplyTo(t)+"execute code:\n\n"+S.textArg(t,0),kind:"code"},{id:611,description:"Set Variable",getListText:t=>"Set variable "+S.textArg(t,0)+" to "+S.textArg(t,1),getHintText:t=>S.textApplyTo(t)+"set variable "+S.textArg(t,0)+" "+S.textRelative(t)+"to "+S.textArg(t,1),kind:"variable"},{id:612,description:"Test Variable",getListText:t=>"If "+S.textArg(t,0)+" is "+S.textNot(t)+S.textArg(t,2)+" "+S.textArg(t,1),getHintText:t=>S.textApplyTo(t)+"if "+S.textArg(t,0)+" is "+S.textNot(t)+S.textArg(t,2)+" "+S.textArg(t,1),kind:"normal",execution:"function",executionFunction:"action_if_variable",interfaceKind:"normal",isQuestion:!0,hasApplyTo:!0,hasRelative:!1,args:[{name:"variable:",kind:"expression",default:""},{name:"value:",kind:"expression",default:"0"},{name:"operation:",kind:"menu",menu:["equal to","smaller than","larger than"],default:"0"}]}]}]}static textArg(t,e){return t.args[e].value.toString()}static textApplyTo(t){return-1==t.appliesTo?"":"for the object "+t.appliesTo.toString+": "}static textRelative(t){return t.relative?"relative ":""}static textNot(t){return t.not?"not ":""}}var S=I,j=t=>document.querySelector(t);HTMLElement.prototype.$=function(t){return this.querySelector(t)};let C=[document.body];var T=t=>(C.push(t),t),R=()=>{C.pop()},O=t=>(C[C.length-1].appendChild(t),t),M=t=>t.parentElement.removeChild(t),B=(t,e,r,i)=>{var s=document.createElement(t);return e&&Object.keys(e).forEach((t=>{null!=e[t]&&s.setAttribute(t,e[t])})),r&&Object.keys(r).forEach((t=>{s.addEventListener(t,r[t])})),i&&s.appendChild(document.createTextNode(i)),s},N=(t,e,r)=>B(e,{class:t},null,r),P=(t,e,r)=>B("button",{class:t},{click:r},e),F=(t,e,r)=>B("canvas",{class:t,width:e,height:r},null,null),L=(t,e,r)=>{var i="_id_"+K(),s=T(B("div",{class:t}));return e&&O(B("label",{for:i},null,e)),O(B("input",{id:i,type:"text",value:r},null,null)),R(),s},G=(t,e,r,i,s,a)=>{var n=L(t,e,r);return n.$("input").type="number",n.$("input").step=i,n.$("input").min=s,n.$("input").max=a,n},D=(t,e,r)=>{var i="_id_"+K(),s=T(B("div",{class:t}));return O(B("input",{id:i,type:"checkbox",...r?{checked:"checked"}:null},null,null)),O(B("label",{for:i},null,e)),R(),s},W=(t,e,r,i)=>{var s="_id_"+K(),a=T(B("div",{class:t}));return O(B("input",{id:s,type:"radio",name:r,...i?{checked:"checked"}:null},null,null)),O(B("label",{for:s},null,e)),R(),a},V=(t,e,r)=>{var i="_id_"+K(),s=T(B("div",{class:t}));return O(B("label",{for:i},null,e)),T(O(B("select",{id:i}))),r&&r.forEach((t=>{O(B("option",{value:t.value},null,t.name))})),R(),R(),s},U=(t,e,r)=>{var i=L(t,e,r);return i.$("input").type="color",i},z=(t,e)=>{var r=B("img",{class:t});return e&&(r.src=e),r},Q=0,K=()=>++Q-1,J=t=>({r:t%256,g:Math.floor(t%65536/256),b:Math.floor(t%16777216/65536)}),q=t=>t.r+256*t.g+256*t.b*256,H=t=>{var e=parseInt(t.substr(1,2),16),r=parseInt(t.substr(3,2),16),i=parseInt(t.substr(5,2),16);return q({r:e,g:r,b:i})},Y=t=>{var e,r,{r:i,g:s,b:a}=J(t),n=Math.max(i,s,a),c=Math.min(i,s,a),o=n,u=n-c;if(r=0==n?0:Math.floor(255*u/n),n==c)e=0;else{switch(n){case i:e=(s-a)/u*42+(s<a?256:0);break;case s:e=(a-i)/u*42+85;break;case a:e=(i-s)/u+42+170}e=Math.floor(e)}return{h:e,s:r,v:o}},X=t=>{var e=J(t);return"rgb("+e.r+","+e.g+","+e.b+")"},Z=(t,e)=>{var r=J(t);return"rgba("+r.r+","+r.g+","+r.b+","+e+")"},$=(t,e,r,i)=>(i?"italic ":"")+(r?"bold ":"")+e+'pt "'+t+'"',tt=t=>{for(var e=[],r=0;r<9;++r)"0"!=t[r]?e.push(!0):e.push(!1);return e};class et{constructor(){}static openDialog(t){return new Promise(((e,r)=>{var i=N(null,"input");i.accept=t,i.type="file",i.onchange=()=>e(i.files[0]),i.click()}))}static readEntireFile(t){return new Promise(((e,r)=>{var i=new FileReader;i.onload=()=>{e(i.result)},i.readAsText(t)}))}static save(t,e){var r=N(null,"a");r.href=URL.createObjectURL(t),r.download=e,r.click()}}var rt=r(733),it=r.n(rt);class st extends Error{constructor(...t){super(...t),this.name=this.constructor.name}}class at extends st{}class nt extends st{}class ct extends st{}class ot extends st{}class ut extends st{}class lt extends st{constructor(t,...e){super(...e),this.value=t}}class _t extends st{}class dt extends st{}class ht{constructor(t,e=!0){this.image=new Image,t instanceof Blob?(this.blob=t,this.src=URL.createObjectURL(t)):this.src=t,this.promise=null,e&&this.load()}load(){this.promise=new Promise(((t,e)=>{this.image.onload=e=>{t()},this.image.onerror=t=>{e(new st("Could not load image"))}})),this.image.src=this.src}toJSON(){}}class pt{static serializeZIP(t){var e=new(it());e.file("version","2"),pt.initClasses();var r=Object.values(pt.classes),i=JSON.stringify(t,(function(t,e){return null!=e&&r.includes(e.constructor)&&(e={...e,$class:e.constructor.name}),e}),"\t");return e.file("project.json",i),t.resources.ProjectSprite.forEach((t=>{t.images.forEach(((r,i)=>{e.file("sprites/"+t.id+"/"+i,r.blob)}))})),t.resources.ProjectBackground.forEach((t=>{e.file("backgrounds/"+t.id,t.image.blob)})),e.generateAsync({type:"blob"})}static unserializeZIP(t){var e,r=new(it());return r.loadAsync(t).then((()=>r.file("version").async("string"))).then((t=>{if(e=parseInt(t),console.log("ZIP version:",e),e<1||e>2)throw new Error("Unsupported version")})).then((()=>r.file("project.json").async("string"))).then((t=>{if(1==e)return pt.unserializeV1(t);if(2==e){var s=[];pt.initClasses();var a=JSON.parse(t,(function(t,e){if(null!=e&&e.$class){var r=new pt.classes[e.$class];return delete(r=Object.assign(r,e)).$class,r}return e}));return i.getTypes().forEach((t=>{null==a.resources[t.name]&&(a.resources[t.name]=[]),null==a.counter[t.name]&&(a.counter[t.name]=0)})),a.resources.ProjectSprite.forEach((t=>{t.images.forEach(((e,i)=>{var a=r.file("sprites/"+t.id+"/"+i);null!=a&&s.push(a.async("blob").then((e=>{t.images[i]=new ht(e)})))}))})),a.resources.ProjectBackground.forEach((t=>{var e=r.file("backgrounds/"+t.id);null!=e&&s.push(e.async("blob").then((e=>{t.image=new ht(e)})))})),Promise.all(s).then((()=>a))}}))}static initClasses(){if(null==pt.classes){var t=[i,s,a,n,c,o,u,l,_,d,h,p,m,g,v,f,y,w,b,A,x,k];for(var e of(pt.classes={},t))pt.classes[e.name]=e}}static unserializeV1(t){var e;try{e=JSON.parse(t)}catch(t){return null}if(!e.resources)return null;i.getTypes().forEach((t=>{e.resources[t.name]?e.resources[t.name]=e.resources[t.name].map((e=>(delete e.classname,"ProjectSprite"==t.name&&(e.images=e.images.map((t=>new ht(((t,e)=>{e=e||"";for(var r=1024,i=atob(t),s=i.length,a=Math.ceil(s/r),n=new Array(a),c=0;c<a;++c){for(var o=c*r,u=Math.min(o+r,s),l=new Array(u-o),_=o,d=0;_<u;++d,++_)l[d]=i[_].charCodeAt(0);n[c]=new Uint8Array(l)}return new Blob(n,{type:e})})(t,"image/png"))))),"ProjectObject"==t.name&&(e.events=e.events.map((t=>(t.actions=t.actions.map((t=>(delete t.classname,Object.assign(new m,t)))),delete t.classname,Object.assign(new p,t))))),"ProjectRoom"==t.name&&(e.instances=e.instances.map((t=>(delete t.classname,Object.assign(new f,t))))),Object.assign(new t,e)))):e.resources[t.name]=[]}));var r=Object.assign(new i,e);return Promise.resolve(r)}}class mt{constructor(t,e){for(var r in this.caller=t,this.builtInClass=e,this.builtInList={},this.customList={},this.builtInClass)"function"==typeof this.builtInClass[r].default?this.builtInList[r]={value:this.builtInClass[r].default.call(this)}:this.builtInList[r]={value:this.builtInClass[r].default||0},this.builtInList[r].dimensions=this.builtInClass[r].dimensions||0,null==this.builtInClass[r].dimensions&&Array.isArray(this.builtInClass[r].default)&&(this.builtInClass[r].dimensions=1)}exists(t){return null!=this.getVariableInfo(t)}get(t,e){var r;null==e&&(e=[]);var i=this.getVariableInfo(t);if(null==i)throw new Error("Variable doesn't exist");var s=(r=i.reference).dimensions-e.length;if(s>0){var a=new Array(s).fill(0);e.unshift(...a)}if(s<0){for(s=Math.abs(s);0==e[0]&&0!=s;)e.shift(),s--;if(0!=s)throw new Error("Index out of bounds (more indexes than dimensions!)")}for(var n of e)if(Array.isArray(r.value)){if(n>=r.value.length)throw new Error("Index out of bounds");null==r.value[n]&&(r.value[n]={value:0}),r=r.value[n]}else if(0!=n)throw new Error("Index out of bounds");return r.value}set(t,e,r,i,s=!0){var a;null==r&&(r=[]);var n=this.getVariableInfo(t);if(null!=n){if(a=n.reference,n.list==this.builtInList){if(this.builtInClass[t].readOnly&&!i)throw new Error("Cannot assign to the variable (it's read only!)");s&&null!=this.caller&&this.builtInClass[t].set&&this.builtInClass[t].set.call(this.caller,e,r)}}else this.customList[t]={dimensions:0,value:0},a=this.customList[t];var c=a.dimensions-r.length;if(c>0){var o=new Array(c).fill(0);r.unshift(...o)}if(c<0){for(c=Math.abs(c);0==r[0];)r.shift(),c--;r.slice(0,c).forEach((t=>{a.dimensions++,a.value=[{value:a.value}]}))}for(var u of r)Array.isArray(a.value)||(a.value=[{value:a.value}]),null==a.value[u]&&(a.value[u]={value:0}),a=a.value[u];a.value=e}clear(t){var e=this.getVariableInfo(t);null!=e&&(e.reference.value=0)}getVariableInfo(t){return null!=this.builtInClass&&null!=this.builtInClass[t]?{reference:this.builtInList[t],list:this.builtInList}:null!=this.customList[t]?{reference:this.customList[t],list:this.customList}:null}setForce(t,e,r){return this.set(t,e,r,!0)}setNoCall(t,e,r,i){return this.set(t,e,r,i,!1)}setAdd(t,e,r,i){var s=this.get(t,r);return this.set(t,s+e,r,i)}save(t){var e=this.getVariableInfo(t);if(null==e)throw new Error("wtf?");var r={};return r.dimensions=e.reference.dimensions,r.value=this.saveValue(e.reference.value),r}load(t,e){var r=this.customList,i=this.getVariableInfo(t);null!=i&&(r=i.list),r[t]=e}saveAll(){return{builtInClass:this.builtInClass,builtInList:this.saveList(this.builtInList),customList:this.saveList(this.customList)}}loadAll(t){this.builtInClass=t.builtInClass,this.builtInList=t.builtInList,this.customList=t.customList}saveList(t){var e={};for(var r of Object.keys(t))e[r]={},e[r].dimensions=t[r].dimensions,e[r].value=this.saveValue(t[r].value);return e}saveValue(t){return Array.isArray(t)?t.map((t=>({value:this.saveValue(t.value)}))):t}clearAll(){this.builtInClass=null,this.builtInList={},this.customList={}}}class gt{static listEventTypes=[{id:0,value:"create",name:"Create",getFullName:()=>"Create"},{id:1,value:"destroy",name:"Destroy",getFullName:()=>"Destroy"},{id:3,value:"step",name:"Step",getFullName:t=>gt.listStepSubtypes[t]},{id:2,value:"alarm",name:"Alarm",getFullName:t=>"Alarm "+t},{id:5,value:"keyboard",name:"Keyboard",getFullName:t=>"Keyboard "+t},{id:6,value:"mouse",name:"Mouse",getFullName:t=>gt.listMouseSubtypes[t]},{id:4,value:"collision",name:"Collision",getFullName:(t,e)=>"Collision with "+e.resources.ProjectObject.find((e=>e.id==t)).name},{id:7,value:"other",name:"Other",getFullName:t=>gt.listOtherSubtypes[t]},{id:8,value:"draw",name:"Draw",getFullName:()=>"Draw"},{id:9,value:"keypress",name:"Key press",getFullName:t=>"Key press"+t},{id:10,value:"keyrelease",name:"Key release",getFullName:t=>"Key release"+t}];static listStepSubtypes={normal:"Step",begin:"Begin step",end:"End step"};static listMouseSubtypes={0:"Left Button",1:"Right Button",2:"Middle Button",3:"No Button",4:"Left Press",5:"Right Press",6:"Middle Press",7:"Left Release",8:"Right Release",9:"Middle Release",10:"Mouse Enter",11:"Mouse Leave",12:"Global Press",13:"Global Release",16:"Joystick1 Left",17:"Joystick1 Right",18:"Joystick1 Up",19:"Joystick1 Down",21:"Joystick1 Button1",22:"Joystick1 Button2",23:"Joystick1 Button3",24:"Joystick1 Button4",25:"Joystick1 Button5",26:"Joystick1 Button6",27:"Joystick1 Button7",28:"Joystick1 Button8",31:"Joystick2 Left",32:"Joystick2 Right",33:"Joystick2 Up",34:"Joystick2 Down",36:"Joystick2 Button1",37:"Joystick2 Button2",38:"Joystick2 Button3",39:"Joystick2 Button4",40:"Joystick2 Button5",41:"Joystick2 Button6",42:"Joystick2 Button7",43:"Joystick2 Button8",50:"Global Left Button",51:"Global Right Button",52:"Global Middle Button",53:"Global Left Press",54:"Global Right Press",55:"Global Middle Press",56:"Global Left Release",57:"Global Right Release",58:"Global Middle Release",60:"Mouse Wheel Up",61:"Mouse Wheel Down"};static listOtherSubtypes={0:"Outside",1:"Boundary",2:"Game start",3:"Game end",4:"Room start",5:"Room end",6:"No more lives",7:"Animation end",8:"End of path",9:"No more health",10:"User 0",11:"User 1",12:"User 2",13:"User 3",14:"User 4",15:"User 5",16:"User 6",17:"User 7",18:"User 8",19:"User 9",20:"User 10",21:"User 11",22:"User 12",23:"User 13",24:"User 14",25:"User 15",30:"Close button"};static getEventName(t,e){return gt.listEventTypes.find((e=>e.value==t.type)).getFullName(t.subtype,e)}}var vt=r(337),ft=r.n(vt);class yt{static abs([t]){return Math.abs(t)}static arccos([t]){return Math.acos(t)}static arcsin([t]){return Math.asin(t)}static arctan([t]){return Math.atan(t)}static arctan2([t]){return Math.atan2(t)}static ceil([t]){return Math.ceil(t)}static choose([...t]){return t[Math.floor(Math.random()*t.length)]}static cos([t]){return Math.cos(t)}static degtorad([t]){return t*this.game.constants.pi/180}static exp([t]){return Math.exp(t)}static floor([t]){return Math.floor(t)}static frac([t]){return t%1}static irandom([t]){return Math.floor(Math.random()*(Math.floor(t)+1))}static irandom_range([t,e]){return Math.floor(Math.random()*(Math.floor(t)-Math.floor(e)+1))+Math.floor(e)}static is_real([t]){return"number"==typeof t}static is_string([t]){return"string"==typeof t}static lengthdir_x([t,e]){return Math.cos(e*this.game.constants.pi/180)*t}static lengthdir_y([t,e]){return Math.sin(e*this.game.constants.pi/180)*t}static ln([t]){return Math.log(t)}static log10([t]){return Math.log10(t)}static log2([t]){return Math.log2(t)}static logn([t,e]){return Math.log(t)/Math.log(e)}static max([...t]){return Math.max(...t)}static mean([...t]){return 0==t.length?0:t.reduce(((t,e)=>t+e))/t.length}static min([...t]){return Math.min(...t)}static point_direction([t,e,r,i]){return 180*Math.atan2(i-e,r-t)/this.game.constants.pi}static point_distance([t,e,r,i]){return Math.hypot(r-t,i-e)}static power([t,e]){return Math.pow(t,e)}static radtodeg([t]){return 180*t/this.game.constants.pi}static random([t]){return Math.random()*t}static random_range([t,e]){return Math.random()*(e-t)+t}static round([t]){return Math.round(t)}static sign([t]){return Math.sign(t)}static sin([t]){return Math.sin(t)}static sqr([t]){return t*t}static sqrt([t]){return Math.sqrt(t)}static tan([t]){return Math.tan(t)}static chr([t]){return String.fromCharCode(t)}static string([t]){return t.toString()}static ord([t]){return t.charCodeAt(0)}static real([t]){return parseFloat(t)}static move_bounce_all([t]){return 0}static move_bounce_solid([t]){return 0}static move_snap([t,e]){return this.currentInstance.vars.set("x",Math.floor(this.currentInstance.vars.get("x")/t)*t),this.currentInstance.vars.set("y",Math.floor(this.currentInstance.vars.get("y")/e)*e),0}static move_towards_point([t,e,r]){return this.currentInstance.vars.set("speed",r),this.currentInstance.vars.set("direction",180*Math.atan2(t,e)/this.game.constants.pi),0}static place_snapped([t,e]){return this.currentInstance.vars.get("x")%t==0&&this.currentInstance.vars.get("y")%e==0}static instance_create([t,e,r]){return this.game.instanceCreate(t,e,r)}static instance_destroy([]){return this.game.shouldDestroyInstances.push(this.currentInstance),0}static instance_exists([t]){var e=this.game.instances.filter((t=>!this.game.shouldDestroyInstances.includes(t)));return(t<0?-1==t?e.find((t=>t==this.currentInstance)):-3==t&&e.length>0:t<1e5?e.find((e=>e.object_index==t)):e.find((e=>e.id==t)))?1:0}static room_goto([t]){return this.game.loadRoom(this.game.project.ProjectRoom.find((e=>e.id==t))),0}static game_end([]){return this.game.shouldEnd=!0,0}static show_debug_message([t]){return console.log(t),0}static keyboard_check([t]){return this.game.key[t]?1:0}static keyboard_check_pressed([t]){return this.game.keyPressed[t]?1:0}static keyboard_check_released([t]){return this.game.keyReleased[t]?1:0}static draw_sprite([t,e,r,i]){if(!(t>=0))throw t+" cannot be less than 0";var s=this.game.project.resources.ProjectSprite.find((e=>e.id==t));if(!s)throw"No sprite with index "+t;if(!s.images[e])throw"No subimage with index "+e+" on sprite "+s.name;return this.game.ctx.save(),this.game.ctx.translate(-s.originx,-s.originy),this.game.ctx.drawImage(s.images[e].image,r,i),this.game.ctx.restore(),0}static color_get_red([t]){return t%256}static color_get_green([t]){return Math.floor(t%65536/256)}static color_get_blue([t]){return Math.floor(t%16777216/65536)}static color_get_hue([t]){return Y(t).h}static color_get_saturation([t]){return Y(t).s}static color_get_value([t]){return Y(t).v}static draw_circle([t,e,r,i]){var s=Z(this.game.drawColor,this.game.drawAlpha);return this.game.ctx.fillStyle=s,this.game.ctx.strokeStyle=s,this.game.ctx.beginPath(),this.game.ctx.arc(t,e,r,0,2*Math.PI),i>=1?this.game.ctx.stroke():this.game.ctx.fill(),this.game.ctx.closePath(),0}static draw_clear([t]){return this.game.ctx.fillStyle=X(t),this.game.ctx.fillRect(0,0,this.game.canvas.width,this.game.canvas.height),0}static draw_ellipse([t,e,r,i,s]){var a=Z(this.game.drawColor,this.game.drawAlpha),n=(r-t)/2+t,c=(i-e)/2+e;return this.game.ctx.fillStyle=a,this.game.ctx.strokeStyle=a,this.game.ctx.beginPath(),this.game.ctx.ellipse(n,c,r-n,i-c,0,0,2*Math.PI),s>=1?this.game.ctx.stroke():this.game.ctx.fill(),this.game.ctx.closePath(),0}static draw_getpixel([t,e]){var r=this.game.ctx.getImageData(t,e,1,1);return q(r[0],r[1],r[2])}static draw_get_alpha([]){return this.game.drawAlpha}static draw_get_color([]){return this.game.drawColor}static draw_line([t,e,r,i]){return this.game.ctx.strokeStyle=Z(this.game.drawColor,this.game.drawAlpha),this.game.ctx.save(),this.game.ctx.translate(.5,.5),this.game.ctx.beginPath(),this.game.ctx.moveTo(t,e),this.game.ctx.lineTo(r,i),this.game.ctx.closePath(),this.game.ctx.stroke(),this.game.ctx.restore(),0}static draw_point([t,e]){return this.game.ctx.fillRect(t,e,1,1),0}static draw_rectangle([t,e,r,i,s]){return this.game.ctx.fillStyle=Z(this.game.drawColor,this.game.drawAlpha),this.game.ctx.strokeStyle=Z(this.game.drawColor,this.game.drawAlpha),this.game.ctx.fillRect(t,e,r-t,i-e),s>=1?this.game.ctx.stroke():this.game.ctx.fill(),0}static draw_set_alpha([t]){return this.game.drawAlpha=t,0}static draw_set_color([t]){return this.game.drawColor=t,0}static make_color_rgb([t,e,r]){return 256*t+256*e*256+256*r*256*256}static draw_set_font([t]){return this.game.drawFont=t,0}static draw_set_halign([t]){return this.game.drawHAlign=t,0}static draw_set_valign([t]){return this.game.drawVAlign=t,0}static draw_text([t,e,r]){this.game.ctx.fillStyle=Z(this.game.drawColor,this.game.drawAlpha);var i=this.game.project.resources.ProjectFont.find((t=>t.id==this.game.drawFont));return this.game.ctx.font=i?$(i.font,i.size,i.bold,i.italic):$("Arial",12,!1,!1),this.game.ctx.textAlign=["left","center","right"][this.game.drawHAlign],this.game.ctx.textBaseline=["top","middle","bottom"][this.game.drawVAlign],this.game.ctx.fillText(r,t,e),0}static draw_point_color([t,e,r]){return this.game.ctx.fillStyle=X(r),this.game.ctx.fillRect(t,e,1,1),0}static draw_set_blend_mode([t]){return 0}static draw_set_blend_mode_ext([t,e]){return this.game.drawBlendModeSrc=t,this.game.drawBlendModeDest=e,0}static get_integer([t,e]){var r=prompt(t,e);return isNaN(parseInt(r,10))?"":r}static get_string([t,e]){return prompt(t,e)||""}static show_message([t]){return alert(t),0}static execute_string([t]){return this.executeString(t),0}static action_move([t,e],r){for(var i=tt(t),s=[225,270,315,180,null,0,135,90,45],a=[],n=0;n<9;++n)i[n]&&a.push(s[n]);var c=a[Math.floor(Math.random()*a.length)];return null!=c?(this.currentInstance.vars.set("direction",c),r?this.currentInstance.vars.setAdd("speed",e):this.currentInstance.vars.set("speed",e)):this.currentInstance.vars.set("speed",0),0}static action_move_to([t,e]){return this.currentInstance.vars.set("x",t),this.currentInstance.vars.set("y",e),0}static action_bounce([t,e]){return 0==e?yt.move_bounce_solid(t):1==e&&yt.move_bounce_all(t),0}static action_wrap([t]){var e=1==t||2==t;return(0==t||2==t)&&(this.currentInstance.vars.get("x")>=this.game.room.width&&this.currentInstance.vars.set("x",this.currentInstance.vars.get("x")-this.game.room.width),this.currentInstance.vars.get("x")<0&&this.currentInstance.vars.set("x",this.game.room.width+this.currentInstance.vars.get("x"))),e&&(this.currentInstance.vars.get("y")>=this.game.room.height&&this.currentInstance.vars.set("y",this.currentInstance.vars.get("y")-this.game.room.height),this.currentInstance.vars.get("y")<0&&this.currentInstance.vars.set("y",this.game.room.height+this.currentInstance.vars.get("y"))),0}static action_message([t]){return yt.show_message([t]),0}static MCI_command([t]){return 0}static action_another_room([t]){return 0}static action_cd_pause([t]){return 0}static action_cd_play([t]){return 0}static action_cd_playing([t]){return 0}static action_cd_present([t]){return 0}static action_cd_resume([t]){return 0}static action_cd_stop([t]){return 0}static action_change_object([t]){return 0}static action_color([t]){return 0}static action_create_object([t]){return 0}static action_create_object_motion([t]){return 0}static action_create_object_random([t]){return 0}static action_current_room([t]){return 0}static action_draw_arrow([t]){return 0}static action_draw_background([t]){return 0}static action_draw_ellipse([t]){return 0}static action_draw_ellipse_gradient([t]){return 0}static action_draw_gradient_hor([t]){return 0}static action_draw_gradient_vert([t]){return 0}static action_draw_health([t]){return 0}static action_draw_life([t]){return 0}static action_draw_life_images([t]){return 0}static action_draw_line([t]){return 0}static action_draw_rectangle([t]){return 0}static action_draw_score([t]){return 0}static action_draw_sprite([t]){return 0}static action_draw_text([t]){return 0}static action_draw_text_transformed([t]){return 0}static action_draw_variable([t]){return 0}static action_effect([t]){return 0}static action_end_game([t]){return 0}static action_end_sound([t]){return 0}static action_execute_script([t]){return 0}static action_font([t]){return 0}static action_fullscreen([t]){return 0}static action_highscore_clear([t]){return 0}static action_highscore_show([t]){return 0}static action_if([t]){return 0}static action_if_aligned([t]){return 0}static action_if_collision([t]){return 0}static action_if_dice([t]){return 0}static action_if_empty([t]){return 0}static action_if_health([t]){return 0}static action_if_life([t]){return 0}static action_if_mouse([t]){return 0}static action_if_next_room([t]){return 0}static action_if_number([t]){return 0}static action_if_object([t]){return 0}static action_if_previous_room([t]){return 0}static action_if_question([t]){return 0}static action_if_score([t]){return 0}static action_if_sound([t]){return 0}static action_if_variable([t]){return 0}static action_inherited([t]){return 0}static action_kill_object([t]){return 0}static action_kill_position([t]){return 0}static action_linear_step([t]){return 0}static action_load_game([t]){return 0}static action_move_contact([t]){return 0}static action_move_point([t]){return 0}static action_move_random([t]){return 0}static action_move_start([t]){return 0}static action_next_room([t]){return 0}static action_partemit_burst([t]){return 0}static action_partemit_create([t]){return 0}static action_partemit_destroy([t]){return 0}static action_partemit_stream([t]){return 0}static action_partsyst_clear([t]){return 0}static action_partsyst_create([t]){return 0}static action_partsyst_destroy([t]){return 0}static action_parttype_color([t]){return 0}static action_parttype_create([t]){return 0}static action_parttype_gravity([t]){return 0}static action_parttype_life([t]){return 0}static action_parttype_secondary([t]){return 0}static action_parttype_speed([t]){return 0}static action_path([t]){return 0}static action_path_end([t]){return 0}static action_path_position([t]){return 0}static action_path_speed([t]){return 0}static action_potential_step([t]){return 0}static action_previous_room([t]){return 0}static action_replace_background([t]){return 0}static action_replace_sound([t]){return 0}static action_replace_sprite([t]){return 0}static action_restart_game([t]){return 0}static action_reverse_xdir([t]){return 0}static action_reverse_ydir([t]){return 0}static action_save_game([t]){return 0}static action_set_alarm([t]){return 0}static action_set_caption([t]){return 0}static action_set_cursor([t]){return 0}static action_set_friction([t]){return 0}static action_set_gravity([t]){return 0}static action_set_health([t]){return 0}static action_set_hspeed([t]){return 0}static action_set_life([t]){return 0}static action_set_motion([t]){return 0}static action_set_score([t]){return 0}static action_set_timeline([t]){return 0}static action_set_timeline_position([t]){return 0}static action_set_timeline_speed([t]){return 0}static action_set_vspeed([t]){return 0}static action_show_info([t]){return 0}static action_show_video([t]){return 0}static action_sleep([t]){return 0}static action_snap([t]){return 0}static action_snapshot([t]){return 0}static action_sound([t]){return 0}static action_splash_image([t]){return 0}static action_splash_settings([t]){return 0}static action_splash_text([t]){return 0}static action_splash_video([t]){return 0}static action_splash_web([t]){return 0}static action_sprite_color([t]){return 0}static action_sprite_set([t]){return 0}static action_sprite_transform([t]){return 0}static action_timeline_pause([t]){return 0}static action_timeline_set([t]){return 0}static action_timeline_start([t]){return 0}static action_timeline_stop([t]){return 0}static action_webpage([t]){return 0}static background_add([t]){return 0}static background_add_background([t]){return 0}static background_assign([t]){return 0}static background_create_color([t]){return 0}static background_create_from_screen([t]){return 0}static background_create_from_surface([t]){return 0}static background_create_gradient([t]){return 0}static background_delete([t]){return 0}static background_duplicate([t]){return 0}static background_exists([t]){return 0}static background_get_height([t]){return 0}static background_get_name([t]){return 0}static background_get_texture([t]){return 0}static background_get_width([t]){return 0}static background_name([t]){return 0}static background_replace([t]){return 0}static background_replace_background([t]){return 0}static background_save([t]){return 0}static background_set_alpha_from_background([t]){return 0}static cd_close_door([t]){return 0}static cd_init([t]){return 0}static cd_length([t]){return 0}static cd_number([t]){return 0}static cd_open_door([t]){return 0}static cd_pause([t]){return 0}static cd_paused([t]){return 0}static cd_play([t]){return 0}static cd_playing([t]){return 0}static cd_position([t]){return 0}static cd_present([t]){return 0}static cd_resume([t]){return 0}static cd_set_position([t]){return 0}static cd_set_track_position([t]){return 0}static cd_stop([t]){return 0}static cd_track([t]){return 0}static cd_track_length([t]){return 0}static cd_track_position([t]){return 0}static clipboard_get_text([t]){return 0}static clipboard_has_text([t]){return 0}static clipboard_set_text([t]){return 0}static collision_circle([t]){return 0}static collision_ellipse([t]){return 0}static collision_line([t]){return 0}static collision_point([t]){return 0}static collision_rectangle([t]){return 0}static d3d_draw_block([t]){return 0}static d3d_draw_cone([t]){return 0}static d3d_draw_cylinder([t]){return 0}static d3d_draw_ellipsoid([t]){return 0}static d3d_draw_floor([t]){return 0}static d3d_draw_wall([t]){return 0}static d3d_end([t]){return 0}static d3d_light_define_direction([t]){return 0}static d3d_light_define_point([t]){return 0}static d3d_light_enable([t]){return 0}static d3d_model_block([t]){return 0}static d3d_model_clear([t]){return 0}static d3d_model_cone([t]){return 0}static d3d_model_create([t]){return 0}static d3d_model_cylinder([t]){return 0}static d3d_model_destroy([t]){return 0}static d3d_model_draw([t]){return 0}static d3d_model_ellipsoid([t]){return 0}static d3d_model_floor([t]){return 0}static d3d_model_load([t]){return 0}static d3d_model_primitive_begin([t]){return 0}static d3d_model_primitive_end([t]){return 0}static d3d_model_save([t]){return 0}static d3d_model_vertex([t]){return 0}static d3d_model_vertex_color([t]){return 0}static d3d_model_vertex_normal([t]){return 0}static d3d_model_vertex_normal_color([t]){return 0}static d3d_model_vertex_normal_texture([t]){return 0}static d3d_model_vertex_normal_texture_color([t]){return 0}static d3d_model_vertex_texture([t]){return 0}static d3d_model_vertex_texture_color([t]){return 0}static d3d_model_wall([t]){return 0}static d3d_primitive_begin([t]){return 0}static d3d_primitive_begin_texture([t]){return 0}static d3d_primitive_end([t]){return 0}static d3d_set_culling([t]){return 0}static d3d_set_depth([t]){return 0}static d3d_set_fog([t]){return 0}static d3d_set_hidden([t]){return 0}static d3d_set_lighting([t]){return 0}static d3d_set_perspective([t]){return 0}static d3d_set_projection([t]){return 0}static d3d_set_projection_ext([t]){return 0}static d3d_set_projection_ortho([t]){return 0}static d3d_set_projection_perspective([t]){return 0}static d3d_set_shading([t]){return 0}static d3d_start([t]){return 0}static d3d_transform_add_rotation_axis([t]){return 0}static d3d_transform_add_rotation_x([t]){return 0}static d3d_transform_add_rotation_y([t]){return 0}static d3d_transform_add_rotation_z([t]){return 0}static d3d_transform_add_scaling([t]){return 0}static d3d_transform_add_translation([t]){return 0}static d3d_transform_set_identity([t]){return 0}static d3d_transform_set_rotation_axis([t]){return 0}static d3d_transform_set_rotation_x([t]){return 0}static d3d_transform_set_rotation_y([t]){return 0}static d3d_transform_set_rotation_z([t]){return 0}static d3d_transform_set_scaling([t]){return 0}static d3d_transform_set_translation([t]){return 0}static d3d_transform_stack_clear([t]){return 0}static d3d_transform_stack_discard([t]){return 0}static d3d_transform_stack_empty([t]){return 0}static d3d_transform_stack_pop([t]){return 0}static d3d_transform_stack_push([t]){return 0}static d3d_transform_stack_top([t]){return 0}static d3d_vertex([t]){return 0}static d3d_vertex_color([t]){return 0}static d3d_vertex_normal([t]){return 0}static d3d_vertex_normal_color([t]){return 0}static d3d_vertex_normal_texture([t]){return 0}static d3d_vertex_normal_texture_color([t]){return 0}static d3d_vertex_texture([t]){return 0}static d3d_vertex_texture_color([t]){return 0}static date_compare_date([t]){return 0}static date_compare_datetime([t]){return 0}static date_compare_time([t]){return 0}static date_create_date([t]){return 0}static date_create_datetime([t]){return 0}static date_create_time([t]){return 0}static date_current_date([t]){return 0}static date_current_datetime([t]){return 0}static date_current_time([t]){return 0}static date_date_of([t]){return 0}static date_date_string([t]){return 0}static date_datetime_string([t]){return 0}static date_day_span([t]){return 0}static date_days_in_month([t]){return 0}static date_days_in_year([t]){return 0}static date_get_day([t]){return 0}static date_get_day_of_year([t]){return 0}static date_get_hour([t]){return 0}static date_get_hour_of_year([t]){return 0}static date_get_minute([t]){return 0}static date_get_minute_of_year([t]){return 0}static date_get_month([t]){return 0}static date_get_second([t]){return 0}static date_get_second_of_year([t]){return 0}static date_get_week([t]){return 0}static date_get_weekday([t]){return 0}static date_get_year([t]){return 0}static date_hour_span([t]){return 0}static date_inc_day([t]){return 0}static date_inc_hour([t]){return 0}static date_inc_minute([t]){return 0}static date_inc_month([t]){return 0}static date_inc_second([t]){return 0}static date_inc_week([t]){return 0}static date_inc_year([t]){return 0}static date_is_today([t]){return 0}static date_leap_year([t]){return 0}static date_minute_span([t]){return 0}static date_month_span([t]){return 0}static date_second_span([t]){return 0}static date_time_of([t]){return 0}static date_time_string([t]){return 0}static date_valid_date([t]){return 0}static date_valid_datetime([t]){return 0}static date_valid_time([t]){return 0}static date_week_span([t]){return 0}static date_year_span([t]){return 0}static directory_create([t]){return 0}static directory_exists([t]){return 0}static discard_include_file([t]){return 0}static disk_free([t]){return 0}static disk_size([t]){return 0}static display_get_colordepth([t]){return 0}static display_get_frequency([t]){return 0}static display_get_height([t]){return 0}static display_get_width([t]){return 0}static display_mouse_get_x([t]){return 0}static display_mouse_get_y([t]){return 0}static display_mouse_set([t]){return 0}static display_reset([t]){return 0}static display_set_all([t]){return 0}static display_set_colordepth([t]){return 0}static display_set_frequency([t]){return 0}static display_set_size([t]){return 0}static display_test_all([t]){return 0}static distance_to_object([t]){return 0}static distance_to_point([t]){return 0}static draw_arrow([t]){return 0}static draw_background([t]){return 0}static draw_background_ext([t]){return 0}static draw_background_general([t]){return 0}static draw_background_part([t]){return 0}static draw_background_part_ext([t]){return 0}static draw_background_stretched([t]){return 0}static draw_background_stretched_ext([t]){return 0}static draw_background_tiled([t]){return 0}static draw_background_tiled_ext([t]){return 0}static draw_button([t]){return 0}static draw_circle_color([t]){return 0}static draw_clear_alpha([t]){return 0}static draw_ellipse_color([t]){return 0}static draw_healthbar([t]){return 0}static draw_highscore([t]){return 0}static draw_line_color([t]){return 0}static draw_line_width([t]){return 0}static draw_line_width_color([t]){return 0}static draw_path([t]){return 0}static draw_primitive_begin([t]){return 0}static draw_primitive_begin_texture([t]){return 0}static draw_primitive_end([t]){return 0}static draw_rectangle_color([t]){return 0}static draw_roundrect([t]){return 0}static draw_roundrect_color([t]){return 0}static draw_set_circle_precision([t]){return 0}static draw_sprite_ext([t]){return 0}static draw_sprite_general([t]){return 0}static draw_sprite_part([t]){return 0}static draw_sprite_part_ext([t]){return 0}static draw_sprite_stretched([t]){return 0}static draw_sprite_stretched_ext([t]){return 0}static draw_sprite_tiled([t]){return 0}static draw_sprite_tiled_ext([t]){return 0}static draw_surface([t]){return 0}static draw_surface_ext([t]){return 0}static draw_surface_general([t]){return 0}static draw_surface_part([t]){return 0}static draw_surface_part_ext([t]){return 0}static draw_surface_stretched([t]){return 0}static draw_surface_stretched_ext([t]){return 0}static draw_surface_tiled([t]){return 0}static draw_surface_tiled_ext([t]){return 0}static draw_text_color([t]){return 0}static draw_text_ext([t]){return 0}static draw_text_ext_color([t]){return 0}static draw_text_ext_transformed([t]){return 0}static draw_text_ext_transformed_color([t]){return 0}static draw_text_transformed([t]){return 0}static draw_text_transformed_color([t]){return 0}static draw_triangle([t]){return 0}static draw_triangle_color([t]){return 0}static draw_vertex([t]){return 0}static draw_vertex_color([t]){return 0}static draw_vertex_texture([t]){return 0}static draw_vertex_texture_color([t]){return 0}static ds_grid_add([t]){return 0}static ds_grid_add_disk([t]){return 0}static ds_grid_add_grid_region([t]){return 0}static ds_grid_add_region([t]){return 0}static ds_grid_clear([t]){return 0}static ds_grid_copy([t]){return 0}static ds_grid_create([t]){return 0}static ds_grid_destroy([t]){return 0}static ds_grid_get([t]){return 0}static ds_grid_get_disk_max([t]){return 0}static ds_grid_get_disk_mean([t]){return 0}static ds_grid_get_disk_min([t]){return 0}static ds_grid_get_disk_sum([t]){return 0}static ds_grid_get_max([t]){return 0}static ds_grid_get_mean([t]){return 0}static ds_grid_get_min([t]){return 0}static ds_grid_get_sum([t]){return 0}static ds_grid_height([t]){return 0}static ds_grid_multiply([t]){return 0}static ds_grid_multiply_disk([t]){return 0}static ds_grid_multiply_grid_region([t]){return 0}static ds_grid_multiply_region([t]){return 0}static ds_grid_read([t]){return 0}static ds_grid_resize([t]){return 0}static ds_grid_set([t]){return 0}static ds_grid_set_disk([t]){return 0}static ds_grid_set_grid_region([t]){return 0}static ds_grid_set_region([t]){return 0}static ds_grid_shuffle([t]){return 0}static ds_grid_value_disk_exists([t]){return 0}static ds_grid_value_disk_x([t]){return 0}static ds_grid_value_disk_y([t]){return 0}static ds_grid_value_exists([t]){return 0}static ds_grid_value_x([t]){return 0}static ds_grid_value_y([t]){return 0}static ds_grid_width([t]){return 0}static ds_grid_write([t]){return 0}static ds_list_add([t]){return 0}static ds_list_clear([t]){return 0}static ds_list_copy([t]){return 0}static ds_list_create([t]){return 0}static ds_list_delete([t]){return 0}static ds_list_destroy([t]){return 0}static ds_list_empty([t]){return 0}static ds_list_find_index([t]){return 0}static ds_list_find_value([t]){return 0}static ds_list_insert([t]){return 0}static ds_list_read([t]){return 0}static ds_list_replace([t]){return 0}static ds_list_shuffle([t]){return 0}static ds_list_size([t]){return 0}static ds_list_sort([t]){return 0}static ds_list_write([t]){return 0}static ds_map_add([t]){return 0}static ds_map_clear([t]){return 0}static ds_map_copy([t]){return 0}static ds_map_create([t]){return 0}static ds_map_delete([t]){return 0}static ds_map_destroy([t]){return 0}static ds_map_empty([t]){return 0}static ds_map_exists([t]){return 0}static ds_map_find_first([t]){return 0}static ds_map_find_last([t]){return 0}static ds_map_find_next([t]){return 0}static ds_map_find_previous([t]){return 0}static ds_map_find_value([t]){return 0}static ds_map_read([t]){return 0}static ds_map_replace([t]){return 0}static ds_map_size([t]){return 0}static ds_map_write([t]){return 0}static ds_priority_add([t]){return 0}static ds_priority_change_priority([t]){return 0}static ds_priority_clear([t]){return 0}static ds_priority_copy([t]){return 0}static ds_priority_create([t]){return 0}static ds_priority_delete_max([t]){return 0}static ds_priority_delete_min([t]){return 0}static ds_priority_delete_value([t]){return 0}static ds_priority_destroy([t]){return 0}static ds_priority_empty([t]){return 0}static ds_priority_find_max([t]){return 0}static ds_priority_find_min([t]){return 0}static ds_priority_find_priority([t]){return 0}static ds_priority_read([t]){return 0}static ds_priority_size([t]){return 0}static ds_priority_write([t]){return 0}static ds_queue_clear([t]){return 0}static ds_queue_copy([t]){return 0}static ds_queue_create([t]){return 0}static ds_queue_dequeue([t]){return 0}static ds_queue_destroy([t]){return 0}static ds_queue_empty([t]){return 0}static ds_queue_enqueue([t]){return 0}static ds_queue_head([t]){return 0}static ds_queue_read([t]){return 0}static ds_queue_size([t]){return 0}static ds_queue_tail([t]){return 0}static ds_queue_write([t]){return 0}static ds_set_precision([t]){return 0}static ds_stack_clear([t]){return 0}static ds_stack_copy([t]){return 0}static ds_stack_create([t]){return 0}static ds_stack_destroy([t]){return 0}static ds_stack_empty([t]){return 0}static ds_stack_pop([t]){return 0}static ds_stack_push([t]){return 0}static ds_stack_read([t]){return 0}static ds_stack_size([t]){return 0}static ds_stack_top([t]){return 0}static ds_stack_write([t]){return 0}static effect_clear([t]){return 0}static effect_create_above([t]){return 0}static effect_create_below([t]){return 0}static environment_get_variable([t]){return 0}static event_inherited([t]){return 0}static event_perform([t]){return 0}static event_perform_object([t]){return 0}static event_user([t]){return 0}static execute_file([t]){return 0}static execute_program([t]){return 0}static execute_shell([t]){return 0}static export_include_file([t]){return 0}static export_include_file_location([t]){return 0}static external_call([t]){return 0}static external_call0([t]){return 0}static external_call1([t]){return 0}static external_call2([t]){return 0}static external_call3([t]){return 0}static external_call4([t]){return 0}static external_call5([t]){return 0}static external_call6([t]){return 0}static external_call7([t]){return 0}static external_call8([t]){return 0}static external_define([t]){return 0}static external_define0([t]){return 0}static external_define1([t]){return 0}static external_define2([t]){return 0}static external_define3([t]){return 0}static external_define4([t]){return 0}static external_define5([t]){return 0}static external_define6([t]){return 0}static external_define7([t]){return 0}static external_define8([t]){return 0}static external_free([t]){return 0}static file_attributes([t]){return 0}static file_bin_close([t]){return 0}static file_bin_open([t]){return 0}static file_bin_position([t]){return 0}static file_bin_read_byte([t]){return 0}static file_bin_rewrite([t]){return 0}static file_bin_seek([t]){return 0}static file_bin_size([t]){return 0}static file_bin_write_byte([t]){return 0}static file_close([t]){return 0}static file_copy([t]){return 0}static file_delete([t]){return 0}static file_eof([t]){return 0}static file_eoln([t]){return 0}static file_exists([t]){return 0}static file_find_close([t]){return 0}static file_find_first([t]){return 0}static file_find_next([t]){return 0}static file_open_append([t]){return 0}static file_open_read([t]){return 0}static file_open_write([t]){return 0}static file_read_real([t]){return 0}static file_read_string([t]){return 0}static file_readln([t]){return 0}static file_rename([t]){return 0}static file_text_close([t]){return 0}static file_text_eof([t]){return 0}static file_text_eoln([t]){return 0}static file_text_open_append([t]){return 0}static file_text_open_read([t]){return 0}static file_text_open_write([t]){return 0}static file_text_read_real([t]){return 0}static file_text_read_string([t]){return 0}static file_text_readln([t]){return 0}static file_text_write_real([t]){return 0}static file_text_write_string([t]){return 0}static file_text_writeln([t]){return 0}static file_write_real([t]){return 0}static file_write_string([t]){return 0}static file_writeln([t]){return 0}static filename_change_ext([t]){return 0}static filename_dir([t]){return 0}static filename_drive([t]){return 0}static filename_ext([t]){return 0}static filename_name([t]){return 0}static filename_path([t]){return 0}static font_add([t]){return 0}static font_add_sprite([t]){return 0}static font_delete([t]){return 0}static font_exists([t]){return 0}static font_get_bold([t]){return 0}static font_get_first([t]){return 0}static font_get_fontname([t]){return 0}static font_get_italic([t]){return 0}static font_get_last([t]){return 0}static font_get_name([t]){return 0}static font_get_size([t]){return 0}static font_name([t]){return 0}static font_replace([t]){return 0}static font_replace_sprite([t]){return 0}static game_load([t]){return 0}static game_restart([t]){return 0}static game_save([t]){return 0}static get_color([t]){return 0}static get_directory([t]){return 0}static get_directory_alt([t]){return 0}static get_open_filename([t]){return 0}static get_save_filename([t]){return 0}static highscore_add([t]){return 0}static highscore_add_current([t]){return 0}static highscore_clear([t]){return 0}static highscore_name([t]){return 0}static highscore_set_background([t]){return 0}static highscore_set_border([t]){return 0}static highscore_set_colors([t]){return 0}static highscore_set_font([t]){return 0}static highscore_set_strings([t]){return 0}static highscore_show([t]){return 0}static highscore_show_ext([t]){return 0}static highscore_value([t]){return 0}static ini_close([t]){return 0}static ini_key_delete([t]){return 0}static ini_key_exists([t]){return 0}static ini_open([t]){return 0}static ini_read_real([t]){return 0}static ini_read_string([t]){return 0}static ini_section_delete([t]){return 0}static ini_section_exists([t]){return 0}static ini_write_real([t]){return 0}static ini_write_string([t]){return 0}static instance_activate_all([t]){return 0}static instance_activate_object([t]){return 0}static instance_activate_region([t]){return 0}static instance_change([t]){return 0}static instance_copy([t]){return 0}static instance_deactivate_all([t]){return 0}static instance_deactivate_object([t]){return 0}static instance_deactivate_region([t]){return 0}static instance_find([t]){return 0}static instance_furthest([t]){return 0}static instance_nearest([t]){return 0}static instance_number([t]){return 0}static instance_place([t]){return 0}static instance_position([t]){return 0}static instance_sprite([t]){return 0}static io_clear([t]){return 0}static io_handle([t]){return 0}static joystick_axes([t]){return 0}static joystick_buttons([t]){return 0}static joystick_check_button([t]){return 0}static joystick_direction([t]){return 0}static joystick_exists([t]){return 0}static joystick_has_pov([t]){return 0}static joystick_name([t]){return 0}static joystick_pov([t]){return 0}static joystick_rpos([t]){return 0}static joystick_upos([t]){return 0}static joystick_vpos([t]){return 0}static joystick_xpos([t]){return 0}static joystick_ypos([t]){return 0}static joystick_zpos([t]){return 0}static keyboard_check_direct([t]){return 0}static keyboard_clear([t]){return 0}static keyboard_get_map([t]){return 0}static keyboard_get_numlock([t]){return 0}static keyboard_key_press([t]){return 0}static keyboard_key_release([t]){return 0}static keyboard_set_map([t]){return 0}static keyboard_set_numlock([t]){return 0}static keyboard_unset_map([t]){return 0}static keyboard_wait([t]){return 0}static load_info([t]){return 0}static make_color([t]){return 0}static make_color_hsv([t]){return 0}static max3([t]){return 0}static median([t]){return 0}static merge_color([t]){return 0}static message_alpha([t]){return 0}static message_background([t]){return 0}static message_button([t]){return 0}static message_button_font([t]){return 0}static message_caption([t]){return 0}static message_input_color([t]){return 0}static message_input_font([t]){return 0}static message_mouse_color([t]){return 0}static message_position([t]){return 0}static message_size([t]){return 0}static message_text_font([t]){return 0}static min3([t]){return 0}static motion_add([t]){return 0}static motion_set([t]){return 0}static mouse_check_button([t]){return 0}static mouse_check_button_pressed([t]){return 0}static mouse_check_button_released([t]){return 0}static mouse_clear([t]){return 0}static mouse_wait([t]){return 0}static mouse_wheel_down([t]){return 0}static mouse_wheel_up([t]){return 0}static move_bounce([t]){return 0}static move_contact([t]){return 0}static move_contact_all([t]){return 0}static move_contact_solid([t]){return 0}static move_outside_all([t]){return 0}static move_outside_solid([t]){return 0}static move_random([t]){return 0}static move_wrap([t]){return 0}static mp_grid_add_cell([t]){return 0}static mp_grid_add_instances([t]){return 0}static mp_grid_add_rectangle([t]){return 0}static mp_grid_clear_all([t]){return 0}static mp_grid_clear_cell([t]){return 0}static mp_grid_clear_rectangle([t]){return 0}static mp_grid_create([t]){return 0}static mp_grid_destroy([t]){return 0}static mp_grid_draw([t]){return 0}static mp_grid_path([t]){return 0}static mp_linear_path([t]){return 0}static mp_linear_path_object([t]){return 0}static mp_linear_step([t]){return 0}static mp_linear_step_object([t]){return 0}static mp_potential_path([t]){return 0}static mp_potential_path_object([t]){return 0}static mp_potential_settings([t]){return 0}static mp_potential_step([t]){return 0}static mp_potential_step_object([t]){return 0}static mplay_connect_status([t]){return 0}static mplay_data_mode([t]){return 0}static mplay_data_read([t]){return 0}static mplay_data_write([t]){return 0}static mplay_end([t]){return 0}static mplay_init_ipx([t]){return 0}static mplay_init_modem([t]){return 0}static mplay_init_serial([t]){return 0}static mplay_init_tcpip([t]){return 0}static mplay_ipaddress([t]){return 0}static mplay_message_clear([t]){return 0}static mplay_message_count([t]){return 0}static mplay_message_id([t]){return 0}static mplay_message_name([t]){return 0}static mplay_message_player([t]){return 0}static mplay_message_receive([t]){return 0}static mplay_message_send([t]){return 0}static mplay_message_send_guaranteed([t]){return 0}static mplay_message_value([t]){return 0}static mplay_player_find([t]){return 0}static mplay_player_id([t]){return 0}static mplay_player_name([t]){return 0}static mplay_session_create([t]){return 0}static mplay_session_end([t]){return 0}static mplay_session_find([t]){return 0}static mplay_session_join([t]){return 0}static mplay_session_mode([t]){return 0}static mplay_session_name([t]){return 0}static mplay_session_status([t]){return 0}static object_add([t]){return 0}static object_delete([t]){return 0}static object_event_add([t]){return 0}static object_event_clear([t]){return 0}static object_exists([t]){return 0}static object_get_depth([t]){return 0}static object_get_mask([t]){return 0}static object_get_name([t]){return 0}static object_get_parent([t]){return 0}static object_get_persistent([t]){return 0}static object_get_solid([t]){return 0}static object_get_sprite([t]){return 0}static object_get_visible([t]){return 0}static object_is_ancestor([t]){return 0}static object_name([t]){return 0}static object_set_depth([t]){return 0}static object_set_mask([t]){return 0}static object_set_parent([t]){return 0}static object_set_persistent([t]){return 0}static object_set_solid([t]){return 0}static object_set_sprite([t]){return 0}static object_set_visible([t]){return 0}static parameter_count([t]){return 0}static parameter_string([t]){return 0}static part_attractor_clear([t]){return 0}static part_attractor_create([t]){return 0}static part_attractor_destroy([t]){return 0}static part_attractor_destroy_all([t]){return 0}static part_attractor_exists([t]){return 0}static part_attractor_force([t]){return 0}static part_attractor_position([t]){return 0}static part_changer_clear([t]){return 0}static part_changer_create([t]){return 0}static part_changer_destroy([t]){return 0}static part_changer_destroy_all([t]){return 0}static part_changer_exists([t]){return 0}static part_changer_kind([t]){return 0}static part_changer_region([t]){return 0}static part_changer_types([t]){return 0}static part_deflector_clear([t]){return 0}static part_deflector_create([t]){return 0}static part_deflector_destroy([t]){return 0}static part_deflector_destroy_all([t]){return 0}static part_deflector_exists([t]){return 0}static part_deflector_friction([t]){return 0}static part_deflector_kind([t]){return 0}static part_deflector_region([t]){return 0}static part_destroyer_clear([t]){return 0}static part_destroyer_create([t]){return 0}static part_destroyer_destroy([t]){return 0}static part_destroyer_destroy_all([t]){return 0}static part_destroyer_exists([t]){return 0}static part_destroyer_region([t]){return 0}static part_emitter_burst([t]){return 0}static part_emitter_clear([t]){return 0}static part_emitter_create([t]){return 0}static part_emitter_destroy([t]){return 0}static part_emitter_destroy_all([t]){return 0}static part_emitter_exists([t]){return 0}static part_emitter_region([t]){return 0}static part_emitter_stream([t]){return 0}static part_particles_clear([t]){return 0}static part_particles_count([t]){return 0}static part_particles_create([t]){return 0}static part_particles_create_color([t]){return 0}static part_system_automatic_draw([t]){return 0}static part_system_automatic_update([t]){return 0}static part_system_clear([t]){return 0}static part_system_create([t]){return 0}static part_system_depth([t]){return 0}static part_system_destroy([t]){return 0}static part_system_draw_order([t]){return 0}static part_system_drawit([t]){return 0}static part_system_exists([t]){return 0}static part_system_position([t]){return 0}static part_system_update([t]){return 0}static part_type_alpha([t]){return 0}static part_type_alpha1([t]){return 0}static part_type_alpha2([t]){return 0}static part_type_alpha3([t]){return 0}static part_type_blend([t]){return 0}static part_type_clear([t]){return 0}static part_type_color([t]){return 0}static part_type_color1([t]){return 0}static part_type_color2([t]){return 0}static part_type_color3([t]){return 0}static part_type_color_hsv([t]){return 0}static part_type_color_mix([t]){return 0}static part_type_color_rgb([t]){return 0}static part_type_create([t]){return 0}static part_type_death([t]){return 0}static part_type_destroy([t]){return 0}static part_type_direction([t]){return 0}static part_type_exists([t]){return 0}static part_type_gravity([t]){return 0}static part_type_life([t]){return 0}static part_type_orientation([t]){return 0}static part_type_scale([t]){return 0}static part_type_shape([t]){return 0}static part_type_size([t]){return 0}static part_type_speed([t]){return 0}static part_type_sprite([t]){return 0}static part_type_step([t]){return 0}static path_add([t]){return 0}static path_add_point([t]){return 0}static path_append([t]){return 0}static path_assign([t]){return 0}static path_change_point([t]){return 0}static path_clear_points([t]){return 0}static path_delete([t]){return 0}static path_delete_point([t]){return 0}static path_duplicate([t]){return 0}static path_end([t]){return 0}static path_exists([t]){return 0}static path_flip([t]){return 0}static path_get_closed([t]){return 0}static path_get_kind([t]){return 0}static path_get_length([t]){return 0}static path_get_name([t]){return 0}static path_get_number([t]){return 0}static path_get_point_speed([t]){return 0}static path_get_point_x([t]){return 0}static path_get_point_y([t]){return 0}static path_get_precision([t]){return 0}static path_get_speed([t]){return 0}static path_get_x([t]){return 0}static path_get_y([t]){return 0}static path_insert_point([t]){return 0}static path_mirror([t]){return 0}static path_name([t]){return 0}static path_reverse([t]){return 0}static path_rotate([t]){return 0}static path_scale([t]){return 0}static path_set_closed([t]){return 0}static path_set_kind([t]){return 0}static path_set_precision([t]){return 0}static path_shift([t]){return 0}static path_start([t]){return 0}static place_empty([t]){return 0}static place_free([t]){return 0}static place_meeting([t]){return 0}static position_change([t]){return 0}static position_destroy([t]){return 0}static position_empty([t]){return 0}static position_meeting([t]){return 0}static random_get_seed([t]){return 0}static random_set_seed([t]){return 0}static randomize([t]){return 0}static registry_exists([t]){return 0}static registry_exists_ext([t]){return 0}static registry_read_real([t]){return 0}static registry_read_real_ext([t]){return 0}static registry_read_string([t]){return 0}static registry_read_string_ext([t]){return 0}static registry_set_root([t]){return 0}static registry_write_real([t]){return 0}static registry_write_real_ext([t]){return 0}static registry_write_string([t]){return 0}static registry_write_string_ext([t]){return 0}static room_add([t]){return 0}static room_assign([t]){return 0}static room_duplicate([t]){return 0}static room_exists([t]){return 0}static room_get_name([t]){return 0}static room_goto_next([t]){return 0}static room_goto_previous([t]){return 0}static room_instance_add([t]){return 0}static room_instance_clear([t]){return 0}static room_name([t]){return 0}static room_next([t]){return 0}static room_previous([t]){return 0}static room_restart([t]){return 0}static room_set_background([t]){return 0}static room_set_background_color([t]){return 0}static room_set_caption([t]){return 0}static room_set_code([t]){return 0}static room_set_height([t]){return 0}static room_set_persistent([t]){return 0}static room_set_view([t]){return 0}static room_set_view_enabled([t]){return 0}static room_set_width([t]){return 0}static room_tile_add([t]){return 0}static room_tile_add_ext([t]){return 0}static room_tile_clear([t]){return 0}static screen_redraw([t]){return 0}static screen_refresh([t]){return 0}static screen_save([t]){return 0}static screen_save_part([t]){return 0}static screen_wait_vsync([t]){return 0}static script_execute([t]){return 0}static script_exists([t]){return 0}static script_get_name([t]){return 0}static script_get_text([t]){return 0}static script_name([t]){return 0}static set_application_title([t]){return 0}static set_automatic_draw([t]){return 0}static set_program_priority([t]){return 0}static set_synchronization([t]){return 0}static show_error([t]){return 0}static show_image([t]){return 0}static show_info([t]){return 0}static show_menu([t]){return 0}static show_menu_pos([t]){return 0}static show_message_ext([t]){return 0}static show_question([t]){return 0}static show_text([t]){return 0}static show_video([t]){return 0}static sleep([t]){return 0}static sound_3d_set_sound_cone([t]){return 0}static sound_3d_set_sound_distance([t]){return 0}static sound_3d_set_sound_position([t]){return 0}static sound_3d_set_sound_velocity([t]){return 0}static sound_add([t]){return 0}static sound_background_tempo([t]){return 0}static sound_delete([t]){return 0}static sound_discard([t]){return 0}static sound_effect_chorus([t]){return 0}static sound_effect_compressor([t]){return 0}static sound_effect_echo([t]){return 0}static sound_effect_equalizer([t]){return 0}static sound_effect_flanger([t]){return 0}static sound_effect_gargle([t]){return 0}static sound_effect_reverb([t]){return 0}static sound_effect_set([t]){return 0}static sound_exists([t]){return 0}static sound_fade([t]){return 0}static sound_get_kind([t]){return 0}static sound_get_name([t]){return 0}static sound_get_preload([t]){return 0}static sound_global_volume([t]){return 0}static sound_isplaying([t]){return 0}static sound_loop([t]){return 0}static sound_name([t]){return 0}static sound_pan([t]){return 0}static sound_play([t]){return 0}static sound_replace([t]){return 0}static sound_restore([t]){return 0}static sound_set_search_directory([t]){return 0}static sound_stop([t]){return 0}static sound_stop_all([t]){return 0}static sound_volume([t]){return 0}static splash_set_adapt([t]){return 0}static splash_set_border([t]){return 0}static splash_set_caption([t]){return 0}static splash_set_close_button([t]){return 0}static splash_set_color([t]){return 0}static splash_set_cursor([t]){return 0}static splash_set_fullscreen([t]){return 0}static splash_set_interrupt([t]){return 0}static splash_set_main([t]){return 0}static splash_set_position([t]){return 0}static splash_set_scale([t]){return 0}static splash_set_size([t]){return 0}static splash_set_stop_key([t]){return 0}static splash_set_stop_mouse([t]){return 0}static splash_set_top([t]){return 0}static splash_show_image([t]){return 0}static splash_show_text([t]){return 0}static splash_show_video([t]){return 0}static splash_show_web([t]){return 0}static sprite_add([t]){return 0}static sprite_add_from_screen([t]){return 0}static sprite_add_from_surface([t]){return 0}static sprite_add_sprite([t]){return 0}static sprite_assign([t]){return 0}static sprite_collision_mask([t]){return 0}static sprite_create_from_screen([t]){return 0}static sprite_create_from_surface([t]){return 0}static sprite_delete([t]){return 0}static sprite_duplicate([t]){return 0}static sprite_exists([t]){return 0}static sprite_get_bbox_bottom([t]){return 0}static sprite_get_bbox_left([t]){return 0}static sprite_get_bbox_right([t]){return 0}static sprite_get_bbox_top([t]){return 0}static sprite_get_height([t]){return 0}static sprite_get_name([t]){return 0}static sprite_get_number([t]){return 0}static sprite_get_texture([t]){return 0}static sprite_get_width([t]){return 0}static sprite_get_xoffset([t]){return 0}static sprite_get_yoffset([t]){return 0}static sprite_merge([t]){return 0}static sprite_name([t]){return 0}static sprite_replace([t]){return 0}static sprite_replace_sprite([t]){return 0}static sprite_save([t]){return 0}static sprite_save_strip([t]){return 0}static sprite_set_alpha_from_sprite([t]){return 0}static sprite_set_offset([t]){return 0}static string_char_at([t]){return 0}static string_copy([t]){return 0}static string_count([t]){return 0}static string_delete([t]){return 0}static string_digits([t]){return 0}static string_format([t]){return 0}static string_height([t]){return 0}static string_height_ext([t]){return 0}static string_insert([t]){return 0}static string_length([t]){return 0}static string_letters([t]){return 0}static string_lettersdigits([t]){return 0}static string_lower([t]){return 0}static string_pos([t]){return 0}static string_repeat([t]){return 0}static string_replace([t]){return 0}static string_replace_all([t]){return 0}static string_upper([t]){return 0}static string_width([t]){return 0}static string_width_ext([t]){return 0}static surface_copy([t]){return 0}static surface_copy_part([t]){return 0}static surface_create([t]){return 0}static surface_exists([t]){return 0}static surface_free([t]){return 0}static surface_get_height([t]){return 0}static surface_get_texture([t]){return 0}static surface_get_width([t]){return 0}static surface_getpixel([t]){return 0}static surface_reset_target([t]){return 0}static surface_save([t]){return 0}static surface_save_part([t]){return 0}static surface_set_target([t]){return 0}static texture_exists([t]){return 0}static texture_get_height([t]){return 0}static texture_get_width([t]){return 0}static texture_preload([t]){return 0}static texture_set_blending([t]){return 0}static texture_set_interpolation([t]){return 0}static texture_set_priority([t]){return 0}static texture_set_repeat([t]){return 0}static tile_add([t]){return 0}static tile_delete([t]){return 0}static tile_delete_at([t]){return 0}static tile_exists([t]){return 0}static tile_find([t]){return 0}static tile_get_alpha([t]){return 0}static tile_get_background([t]){return 0}static tile_get_blend([t]){return 0}static tile_get_depth([t]){return 0}static tile_get_height([t]){return 0}static tile_get_left([t]){return 0}static tile_get_top([t]){return 0}static tile_get_visible([t]){return 0}static tile_get_width([t]){return 0}static tile_get_x([t]){return 0}static tile_get_xscale([t]){return 0}static tile_get_y([t]){return 0}static tile_get_yscale([t]){return 0}static tile_layer_delete([t]){return 0}static tile_layer_delete_at([t]){return 0}static tile_layer_depth([t]){return 0}static tile_layer_find([t]){return 0}static tile_layer_hide([t]){return 0}static tile_layer_shift([t]){return 0}static tile_layer_show([t]){return 0}static tile_set_alpha([t]){return 0}static tile_set_background([t]){return 0}static tile_set_blend([t]){return 0}static tile_set_depth([t]){return 0}static tile_set_position([t]){return 0}static tile_set_region([t]){return 0}static tile_set_scale([t]){return 0}static tile_set_visible([t]){return 0}static timeline_add([t]){return 0}static timeline_clear([t]){return 0}static timeline_delete([t]){return 0}static timeline_exists([t]){return 0}static timeline_get_name([t]){return 0}static timeline_moment_add([t]){return 0}static timeline_moment_clear([t]){return 0}static timeline_name([t]){return 0}static transition_define([t]){return 0}static transition_exists([t]){return 0}static variable_global_array2_get([t]){return 0}static variable_global_array2_set([t]){return 0}static variable_global_array_get([t]){return 0}static variable_global_array_set([t]){return 0}static variable_global_exists([t]){return 0}static variable_global_get([t]){return 0}static variable_global_set([t]){return 0}static variable_local_array2_get([t]){return 0}static variable_local_array2_set([t]){return 0}static variable_local_array_get([t]){return 0}static variable_local_array_set([t]){return 0}static variable_local_exists([t]){return 0}static variable_local_get([t]){return 0}static variable_local_set([t]){return 0}static window_center([t]){return 0}static window_default([t]){return 0}static window_get_caption([t]){return 0}static window_get_color([t]){return 0}static window_get_cursor([t]){return 0}static window_get_fullscreen([t]){return 0}static window_get_height([t]){return 0}static window_get_region_height([t]){return 0}static window_get_region_scale([t]){return 0}static window_get_region_width([t]){return 0}static window_get_showborder([t]){return 0}static window_get_showicons([t]){return 0}static window_get_sizeable([t]){return 0}static window_get_stayontop([t]){return 0}static window_get_visible([t]){return 0}static window_get_width([t]){return 0}static window_get_x([t]){return 0}static window_get_y([t]){return 0}static window_handle([t]){return 0}static window_mouse_get_x([t]){return 0}static window_mouse_get_y([t]){return 0}static window_mouse_set([t]){return 0}static window_set_caption([t]){return 0}static window_set_color([t]){return 0}static window_set_cursor([t]){return 0}static window_set_fullscreen([t]){return 0}static window_set_position([t]){return 0}static window_set_rectangle([t]){return 0}static window_set_region_scale([t]){return 0}static window_set_region_size([t]){return 0}static window_set_showborder([t]){return 0}static window_set_showicons([t]){return 0}static window_set_size([t]){return 0}static window_set_sizeable([t]){return 0}static window_set_stayontop([t]){return 0}static window_set_visible([t]){return 0}static window_view_mouse_get_x([t]){return 0}static window_view_mouse_get_y([t]){return 0}static window_view_mouse_set([t]){return 0}static window_views_mouse_get_x([t]){return 0}static window_views_mouse_get_y([t]){return 0}static window_views_mouse_set([t]){return 0}}class wt{constructor(t){this.game=t;let e=this;this.vars=new mt,this.currentInstance=null,this.gameShouldEnd=!1,this.grammar=ft().grammar(class{static getText(){return String.raw`

GameMakerLanguage {

	Start
		= Code

	Code
		= Block
		| ListOfStatements

	space += comment | multiComment

	comment
		= "//" #(~eol any)*
	multiComment
		= "/*" #(~"*/" any)* "*/"

	eol
		= "\n"
		| "\r"

	Block
		= "{" ListOfStatements "}"

	ListOfStatements
		= Statement*

	Statement
		= StatementNoSemicolon ";"*

	StatementNoSemicolon
		= If
		| While
		| Exit
		| Return
		| Break
		| Continue
		| Function
		| VarDeclare
		| GlobalVarDeclare
		| Assignment
		| AssignmentAdd
		| AssignmentSubtract
		| AssignmentMultiply
		| AssignmentDivide

	BlockOrStatement
		= Block
		| Statement

	If
		= "if" Expression BlockOrStatement Else?
	Else
		= "else" BlockOrStatement

	While
		= "while" Expression BlockOrStatement

	Exit
		= "exit"
	Return
		= "return" Expression
	Break
		= "break"
	Continue
		= "continue"

	Function
		= Name "(" ListOf<Expression,","> ")"

	Name
		= (letter | "_") (alnum | "_")*

	Expression
		= ExpressionUnary
		| ExpressionBooleanComparison

	ExpressionUnary
		= Not
		| Negate
		| NegateBitwise

	Not
		= "!" Expression
	Negate
		= "-" Expression
	NegateBitwise
		= "~" Expression

	ExpressionBooleanComparison
		= And
		| Or
		| Xor
		| ExpressionComparison

	And
		= Expression "&&" ExpressionComparison
	Or
		= Expression "||" ExpressionComparison	
	Xor
		= Expression "^^" ExpressionComparison

	ExpressionComparison
		= Less
		| LessOrEqual
		| Equal
		| Different
		| Greater
		| GreaterOrEqual
		| ExpressionBitwise

	Less
		= Expression "<" ExpressionBitwise
	LessOrEqual
		= Expression "<=" ExpressionBitwise
	Equal
		= Expression equalSymbol ExpressionBitwise
	equalSymbol
		= "=" "="?
	Different
		= Expression "!=" ExpressionBitwise
	Greater
		= Expression ">" ExpressionBitwise
	GreaterOrEqual
		= Expression ">=" ExpressionBitwise

	ExpressionBitwise
		= BitwiseAnd
		| BitwiseOr
		| BitwiseXor
		| ExpressionBitwiseShift

	BitwiseAnd
		= Expression "&" ExpressionBitwiseShift
	BitwiseOr
		= Expression "|" ExpressionBitwiseShift
	BitwiseXor
		= Expression "^" ExpressionBitwiseShift

	ExpressionBitwiseShift
		= BitwiseShiftLeft
		| BitwiseShiftRight
		| ExpressionAddOrSubtract

	BitwiseShiftLeft
		= Expression "<<" ExpressionAddOrSubtract
	BitwiseShiftRight
		= Expression ">>" ExpressionAddOrSubtract

	ExpressionAddOrSubtract
		= Add
		| Subtract
		| ExpressionMultiplyOrDivide

	Add
		= Expression "+" ExpressionMultiplyOrDivide
	Subtract
		= Expression "-" ExpressionMultiplyOrDivide

	ExpressionMultiplyOrDivide
		= Multiply
		| Divide
		| IntegerDivision
		| Modulo
		| OtherExpression

	Multiply
		= ExpressionMultiplyOrDivide "*" OtherExpression
	Divide
		= ExpressionMultiplyOrDivide "/" OtherExpression
	IntegerDivision
		= ExpressionMultiplyOrDivide "div" OtherExpression
	Modulo
		= ExpressionMultiplyOrDivide "mod" OtherExpression

	OtherExpression
		= Parentheses
		| Function
		| Number
		| String
		| VariableGet

	Parentheses
		= "(" Expression ")"

	Number
		= digit+ "."? digit*

	String
		= "\"" #(~"\"" any)* "\""
		| "'" #(~"'" any)* "'"

	// TODO add objects and arrays HERE
	Variable
		= Name ArrayIndexes?

	VariableGet
		= Variable

	ArrayIndexes
		= "[" Expression ArrayIndex2? "]"

	ArrayIndex2
		= "," Expression

	Assignment
		= Variable "=" Expression

	AssignmentAdd
		= Variable "+=" Expression
	AssignmentSubtract
		= Variable "-=" Expression
	AssignmentMultiply
		= Variable "*=" Expression
	AssignmentDivide
		= Variable "/=" Expression

	VarDeclare
		= "var" NonemptyListOf<Name, ",">

	GlobalVarDeclare
		= "globalvar" NonemptyListOf<Name, ",">

}

`}}.getText()),this.semantics=this.grammar.createSemantics(),this.semantics.addOperation("interpret",{Start:t=>(t.interpret(),0),Block:(t,e,r)=>e.interpret(),Statement:(t,e)=>t.interpret(),If(t,r,i,s){var a=r.interpret();"number"!=typeof a&&e.game.throwErrorInGMLNode('Expression expected (condition "'+a.toString()+'" is not a number)',r),a>=.5?i.interpret():s.interpret()},Else:(t,e)=>e.interpret(),While(t,r,i){for(;;){var s=r.interpret();if("number"!=typeof s&&e.game.throwErrorInGMLNode('Expression expected (condition "'+s.toString()+'" is not a number)',r),!(s>=.5))break;try{i.interpret()}catch(t){if(t instanceof _t)break;if(t instanceof dt)continue;throw t}}},Exit(t){throw new ut},Return(t,e){throw new lt(e.interpret())},Break(t){throw new _t},Continue(t){throw new dt},Function(t,r,i,s){var a=t.sourceString,n=i.asIteration().interpret(),c=e.game.project.resources.ProjectScript.find((t=>t.name==a));if(c){var o=e.game.globalVars.save("argument"),u=[];for(let t=0;t<16;t++)u[t]=e.game.globalVars.save("argument"+t.toString());var l=e.game.globalVars.save("argument_relative");e.game.globalVars.clear("argument");for(let t=0;t<16;t++){var _=null==n[t]?0:n[t];e.game.globalVars.setForce("argument",_,[t]),e.game.globalVars.setForce("argument"+t.toString(),_)}e.game.globalVars.setForce("argument_relative",0);var d=e.execute(e.game.preparedCodes.get(c),e.currentInstance);e.game.globalVars.load("argument",o);for(var h=0;h<16;h++)e.game.globalVars.load("argument"+h.toString(),u[h]);return e.game.globalVars.load("argument_relative",l),d}return e.builtInFunction(a,n,e.currentInstance)},Not:(t,e)=>e.interpret()>=.5?0:1,Negate:(t,e)=>-e.interpret(),NegateBitwise:(t,e)=>~e.interpret(),And(t,e,r){var i=t.interpret()>=.5,s=r.interpret()>=.5;return i&&s?1:0},Or(t,e,r){var i=t.interpret()>=.5,s=r.interpret()>=.5;return i||s?1:0},Xor:(t,e,r)=>t.interpret()>=.5!=r.interpret()>=.5?1:0,Less:(t,e,r)=>t.interpret()<r.interpret()?1:0,LessOrEqual:(t,e,r)=>t.interpret()<=r.interpret()?1:0,Equal:(t,e,r)=>t.interpret()===r.interpret()?1:0,Different:(t,e,r)=>t.interpret()!==r.interpret()?1:0,Greater:(t,e,r)=>t.interpret()>r.interpret()?1:0,GreaterOrEqual:(t,e,r)=>t.interpret()>=r.interpret()?1:0,BitwiseAnd:(t,e,r)=>t.interpret()&r.interpret(),BitwiseOr:(t,e,r)=>t.interpret()|r.interpret(),BitwiseXor:(t,e,r)=>t.interpret()^r.interpret(),BitwiseShiftLeft:(t,e,r)=>t.interpret()<<r.interpret(),BitwiseShiftRight:(t,e,r)=>t.interpret()>>r.interpret(),Add:(t,e,r)=>t.interpret()+r.interpret(),Subtract:(t,e,r)=>t.interpret()-r.interpret(),Multiply:(t,e,r)=>t.interpret()*r.interpret(),Divide:(t,e,r)=>t.interpret()/r.interpret(),IntegerDivision(t,e,r){var i=t.interpret(),s=r.interpret();return Math.floor(i/s)},Modulo:(t,e,r)=>t.interpret()%r.interpret(),Parentheses:(t,e,r)=>e.interpret(),Number:(t,e,r)=>Number(t.sourceString+e.sourceString+r.sourceString),String:(t,e,r)=>e.sourceString,Variable(t,e){var r={};return r.name=t.sourceString,r.object=null,r.indexes=e.interpret()[0],r},VariableGet(t){var r=t.interpret();return e.varGet(r,t)},ArrayIndexes(t,r,i,s){var a=[],n=r.interpret();a.push(e.arrayIndexValidate(n,r));var c=i.interpret();return 1==c.length&&a.push(c[0]),a},ArrayIndex2:(t,r)=>e.arrayIndexValidate(r.interpret(),r),Assignment(t,r,i){var s=t.interpret(),a=i.interpret();e.varSet(s,a)},AssignmentAdd(t,r,i){var s=t.interpret(),a=i.interpret();e.varModify(s,(t=>t+a))},AssignmentSubtract(t,r,i){var s=t.interpret(),a=i.interpret();e.varModify(s,(t=>t-a))},AssignmentMultiply(t,r,i){var s=t.interpret(),a=i.interpret();e.varModify(s,(t=>t*a))},AssignmentDivide(t,r,i){var s=t.interpret(),a=i.interpret();e.varModify(s,(t=>t/a))},VarDeclare(t,r){r.asIteration().children.forEach((t=>{var r=t.sourceString;e.vars.exists(r)||e.vars.set(r,null)}))},GlobalVarDeclare(t,r){r.asIteration().children.forEach((t=>{var r=t.sourceString;e.game.globalVars.exists(r)||e.game.globalVars.set(r,0)}))},_iter:(...t)=>t.map((t=>t.interpret()))})}varGet(t,e){if(this.vars.exists(t.name)){var r=this.vars.get(t.name,t.indexes);if(null!=r)return r;this.game.throwErrorInGMLNode("Unknown variable "+t.name,e)}return this.currentInstance.vars.exists(t.name)?this.currentInstance.vars.get(t.name,t.indexes):this.game.globalVars.exists(t.name)?this.game.globalVars.get(t.name,t.indexes):null!=this.game.constants[t.name]?this.game.constants[t.name]:void this.game.throwErrorInGMLNode("Unknown variable "+t.name,e)}varSet(t,e,r){return this.vars.exists(t.name)?this.vars.set(t.name,e,t.indexes):this.currentInstance.vars.exists(t.name)?this.currentInstance.vars.set(t.name,e,t.indexes):this.game.globalVars.exists(t.name)?this.game.globalVars.set(t.name,e,t.indexes):(null!=this.game.constants[t.name]&&this.game.throwErrorInGMLNode("Cannot assign to the variable (it's a constant!)",r),void this.currentInstance.vars.set(t.name,e,t.indexes))}varModify(t,e,r){var i=e(this.varGet(t,r));this.varSet(t,i,r)}operationAdd(t,e){}arrayIndexValidate(t,e){return"number"!=typeof t&&this.game.throwErrorInGMLNode("Wrong type of array index",e),t<0&&this.game.throwErrorInGMLNode("Negative array index",e),t}prepare(t,e){return this.grammar.match(t,e)}execute(t,e){if(t.succeeded()){this.currentInstance=e;var r=this.vars.saveAll();this.vars.clearAll();var i=0;try{i=this.semantics(t).interpret()}catch(t){if(t instanceof ut||t instanceof _t||t instanceof dt);else{if(!(t instanceof lt))throw t;i=t.value}}return this.vars.loadAll(r),this.game.shouldEnd&&this.game.gameEnd(),i}console.log(t.message),console.log("Some error was found in the GML!")}executeString(t,e){return this.execute(this.prepare(t),e)}executeStringExpression(t,e){return this.execute(this.prepare(t,"Expression"),e)}builtInFunction(t,e,r,i){var s=yt[t];if(s)return this.currentInstance=r,s.call(this,e,i);this.game.throwErrorInCurrent('No such function called "'+t+'".')}}class bt{constructor(t){this.actions=t,this.actionNumber=0}parse(){for(var t=[];this.actionNumber<this.actions.length;){var e=this.parseAction();null!=e&&t.push(e)}return t}parseAction(){var t=this.actions[this.actionNumber];switch(this.actionNumber++,t.typeKind){case"normal":{let i={args:t.args,appliesTo:t.appliesTo,relative:t.relative,action:t,actionNumber:this.actionNumber-1};if("function"==t.typeExecution?(i.type="executeFunction",i.function=t.typeExecutionFunction):"code"==t.typeExecution&&(i.type="executeCode",i.code=t.typeExecutionCode),t.typeIsQuestion){i={type:"if",condition:i};var e=this.parseAction(),r=null;this.parseElseIfExists()&&(r=this.parseAction()),t.not?(i.ifTrue=r,i.ifFalse=e):(i.ifTrue=e,i.ifFalse=r)}return i}case"begin":var i=this.parseBlock();return i.length>0?{type:"block",actions:i}:null;case"end":case"else":return null;case"exit":return{type:"exit"};case"repeat":return{type:"repeat",times:t.args[0],treeAction:this.parseAction()};case"variable":return{type:"variable",name:t.args[0],value:t.args[1],appliesTo:t.appliesTo,relative:t.relative,action:t,actionNumber:this.actionNumber-1};case"code":return{type:"code",code:t.args[0],appliesTo:t.appliesTo,relative:t.relative,action:t,actionNumber:this.actionNumber-1}}}parseBlock(){for(var t=[];this.actionNumber<this.actions.length;){if("end"==this.actions[this.actionNumber].typeKind){this.actionNumber++;break}var e=this.parseAction();null!=e&&t.push(e)}return t}parseElseIfExists(){return"else"==this.actions[this.actionNumber].typeKind&&(this.actionNumber++,!0)}}class At{static id={readOnly:!0};static object_index={readOnly:!0};static sprite_index={default:-1};static visible={};static solid={};static depth={};static persistent={};static parent={default:-1};static mask={default:-1};static x={};static y={};static alarm={default:()=>new Array(12).fill(0)};static image_index={};static friction={};static direction={set(t){var e=t*this.game.constants.pi/180;return this.vars.setNoCall("hspeed",Math.cos(e)*this.vars.get("speed")),this.vars.setNoCall("vspeed",Math.sin(e)*this.vars.get("speed")),t}};static speed={set(t){var e=this.vars.get("direction")*this.game.constants.pi/180;return this.vars.setNoCall("hspeed",Math.cos(e)*t),this.vars.setNoCall("vspeed",Math.sin(e)*t),t}};static hspeed={set(t){var e=this.vars.get("vspeed");return this.vars.setNoCall("speed",Math.hypot(t,e)),this.vars.setNoCall("direction",180*Math.atan2(e,t)/this.game.constants.pi),t}};static vspeed={set(t){var e=this.vars.get("hspeed");return this.vars.setNoCall("speed",Math.hypot(e,t)),this.vars.setNoCall("direction",180*Math.atan2(t,e)/this.game.constants.pi),t}}}class xt{static argument={default:()=>new Array(16).fill(0)};static argument0={default:0};static argument1={default:0};static argument2={default:0};static argument3={default:0};static argument4={default:0};static argument5={default:0};static argument6={default:0};static argument7={default:0};static argument8={default:0};static argument9={default:0};static argument10={default:0};static argument11={default:0};static argument12={default:0};static argument13={default:0};static argument14={default:0};static argument15={default:0};static argument_relative={default:0};static instance_count={default:()=>new Array(0).fill(-4),readOnly:!0};static instance_id={default:[],readOnly:!0};static room_speed={default:30};static fps={default:0,readOnly:!0};static current_time={default:0,readOnly:!0};static current_year={default:0,readOnly:!0};static current_month={default:0,readOnly:!0};static current_day={default:0,readOnly:!0};static current_weekday={default:0,readOnly:!0};static current_hour={default:0,readOnly:!0};static current_minute={default:0,readOnly:!0};static current_second={default:0,readOnly:!0};static room={default:0};static room_first={default:0,readOnly:!0};static room_last={default:0,readOnly:!0};static room_width={default:640,readOnly:!0};static room_height={default:480,readOnly:!0};static room_caption={default:""};static room_persistent={default:0};static transition_kind={default:0};static transition_steps={default:80};static score={default:0};static lives={default:-1};static health={default:100};static show_score={default:1};static show_lives={default:0};static show_health={default:0};static caption_health={default:"Health: "};static caption_lives={default:"Lives: "};static caption_score={default:"Score: "};static event_type={default:11,readOnly:!0};static event_number={default:0,readOnly:!0};static event_object={default:0,readOnly:!0};static event_action={default:0,readOnly:!0};static error_occurred={default:0};static error_last={default:""};static debug_mode={default:0,readOnly:!0};static gamemaker_pro={default:1};static gamemaker_registered={default:1};static gamemaker_version={default:800};static keyboard_lastkey={default:0};static keyboard_key={default:0};static keyboard_lastchar={default:""};static keyboard_string={default:""};static mouse_x={default:0,readOnly:!0};static mouse_y={default:0,readOnly:!0};static mouse_button={default:0};static mouse_lastbutton={default:0};static cursor_sprite={default:-1};static background_color={default:12632256};static background_showcolor={default:1};static background_visible={default:()=>new Array(8).fill(0)};static background_foreground={default:()=>new Array(8).fill(0)};static background_index={default:()=>new Array(8).fill(-1)};static background_x={default:()=>new Array(8).fill(0)};static background_y={default:()=>new Array(8).fill(0)};static background_width={default:()=>new Array(8).fill(0),readOnly:!0};static background_height={default:()=>new Array(8).fill(0),readOnly:!0};static background_htiled={default:()=>new Array(8).fill(1)};static background_vtiled={default:()=>new Array(8).fill(1)};static background_xscale={default:()=>new Array(8).fill(1)};static background_yscale={default:()=>new Array(8).fill(1)};static background_hspeed={default:()=>new Array(8).fill(0)};static background_vspeed={default:()=>new Array(8).fill(0)};static background_blend={default:()=>new Array(8).fill(16777215)};static background_alpha={default:()=>new Array(8).fill(1)};static view_enabled={default:0};static view_current={default:0,readOnly:!0};static view_visible={default:()=>new Array(8).fill(0)};static view_xview={default:()=>new Array(8).fill(0)};static view_yview={default:()=>new Array(8).fill(0)};static view_wview={default:()=>new Array(8).fill(640)};static view_hview={default:()=>new Array(8).fill(480)};static view_xport={default:()=>new Array(8).fill(0)};static view_yport={default:()=>new Array(8).fill(0)};static view_wport={default:()=>new Array(8).fill(640)};static view_hport={default:()=>new Array(8).fill(480)};static view_angle={default:()=>new Array(8).fill(0)};static view_hborder={default:()=>new Array(8).fill(32)};static view_vborder={default:()=>new Array(8).fill(32)};static view_hspeed={default:()=>new Array(8).fill(-1)};static view_vspeed={default:()=>new Array(8).fill(-1)};static view_object={default:()=>new Array(8).fill(-1)};static game_id={default:0,readOnly:!0};static working_directory={default:"",readOnly:!0};static program_directory={default:"",readOnly:!0};static temp_directory={default:"",readOnly:!0};static secure_mode={default:0,readOnly:!0}}class kt{constructor(t,e,r){this.project=t,this.canvas=e,this.input=r,this.dispatcher=new E}init(){try{this.initNoCatch()}catch(t){this.dealWithException(t)}}dealWithException(t){if(t instanceof at)this.close(t);else{if(!(t instanceof nt||t instanceof ct))throw t;this.close()}}initNoCatch(){this.initRender(),this.initInput();var t=[];t.push(this.loadSprites()),this.initGML(),this.globalVars=new mt(this,xt),this.constants=class{static getList(){return{true:1,false:0,pi:3.141592654,vk_nokey:0,vk_anykey:1,vk_backspace:8,vk_tab:9,vk_enter:13,vk_return:13,vk_shift:16,vk_control:17,vk_alt:18,vk_pause:19,vk_escape:27,vk_space:32,vk_pageup:33,vk_pagedown:34,vk_end:35,vk_home:36,vk_left:37,vk_up:38,vk_right:39,vk_down:40,vk_printscreen:44,vk_insert:45,vk_delete:46,vk_numpad0:96,vk_numpad1:97,vk_numpad2:98,vk_numpad3:99,vk_numpad4:100,vk_numpad5:101,vk_numpad6:102,vk_numpad7:103,vk_numpad8:104,vk_numpad9:105,vk_multiply:106,vk_add:107,vk_subtract:109,vk_decimal:110,vk_divide:111,vk_f1:112,vk_f2:113,vk_f3:114,vk_f4:115,vk_f5:116,vk_f6:117,vk_f7:118,vk_f8:119,vk_f9:120,vk_f10:121,vk_f11:122,vk_f12:123,vk_lshift:160,vk_rshift:161,vk_lcontrol:162,vk_rcontrol:163,vk_lalt:164,vk_ralt:165,mb_any:-1,mb_left:1,mb_middle:3,mb_none:0,mb_right:2,ev_create:0,ev_destroy:1,ev_alarm:2,ev_step:3,ev_collision:4,ev_keyboard:5,ev_mouse:6,ev_other:7,ev_draw:8,ev_keypress:9,ev_keyrelease:10,ev_trigger:11,ev_step_normal:0,ev_step_begin:1,ev_step_end:2,ev_left_button:0,ev_right_button:1,ev_middle_button:2,ev_no_button:3,ev_left_press:4,ev_right_press:5,ev_middle_press:6,ev_left_release:7,ev_right_release:8,ev_middle_release:9,ev_mouse_enter:10,ev_mouse_leave:11,ev_global_press:12,ev_global_release:13,ev_joystick1_left:16,ev_joystick1_right:17,ev_joystick1_up:18,ev_joystick1_down:19,ev_joystick1_button1:21,ev_joystick1_button2:22,ev_joystick1_button3:23,ev_joystick1_button4:24,ev_joystick1_button5:25,ev_joystick1_button6:26,ev_joystick1_button7:27,ev_joystick1_button8:28,ev_joystick2_left:31,ev_joystick2_right:32,ev_joystick2_up:33,ev_joystick2_down:34,ev_joystick2_button1:36,ev_joystick2_button2:37,ev_joystick2_button3:38,ev_joystick2_button4:39,ev_joystick2_button5:40,ev_joystick2_button6:41,ev_joystick2_button7:42,ev_joystick2_button8:43,ev_global_left_button:50,ev_global_right_button:51,ev_global_middle_button:52,ev_global_left_press:53,ev_global_right_press:54,ev_global_middle_press:55,ev_global_left_release:56,ev_global_right_release:57,ev_global_middle_release:58,ev_mouse_wheel_up:60,ev_mouse_wheel_down:61,ev_outside:0,ev_boundary:1,ev_game_start:2,ev_game_end:3,ev_room_start:4,ev_room_end:5,ev_no_more_lives:6,ev_animation_end:7,ev_end_of_path:8,ev_no_more_health:9,ev_user0:10,ev_user1:11,ev_user2:12,ev_user3:13,ev_user4:14,ev_user5:15,ev_user6:16,ev_user7:17,ev_user8:18,ev_user9:19,ev_user10:20,ev_user11:21,ev_user12:22,ev_user13:23,ev_user14:24,ev_user15:25,ev_close_button:30,bm_normal:0,bm_add:1,bm_subtract:3,bm_max:2,bm_zero:1,bm_one:2,bm_src_color:3,bm_inv_src_color:4,bm_src_alpha:5,bm_inv_src_alpha:6,bm_dest_alpha:7,bm_inv_dest_alpha:8,bm_dest_color:9,bm_inv_dest_color:10,bm_src_alpha_sat:11,c_black:0,c_maroon:128,c_red:255,c_green:32768,c_olive:32896,c_lime:65280,c_yellow:65535,c_dkgray:4210752,c_orange:4235519,c_navy:8388608,c_purple:8388736,c_teal:8421376,c_gray:8421504,c_ltgray:12632256,c_silver:12632256,c_blue:16711680,c_fuchsia:16711935,c_aqua:16776960,c_white:16777215,cr_default:0,cr_none:-1,cr_arrow:-2,cr_arrrow:-2,cr_cross:-3,cr_beam:-4,cr_size_nesw:-6,cr_size_ns:-7,cr_size_nwse:-8,cr_size_we:-9,cr_uparrow:-10,cr_hourglass:-11,cr_drag:-12,cr_nodrop:-13,cr_hsplit:-14,cr_vsplit:-15,cr_multidrag:-16,cr_sqlwait:-17,cr_no:-18,cr_appstart:-19,cr_help:-20,cr_handpoint:-21,cr_size_all:-22,dll_cdecl:0,dll_stdcall:1,ef_explosion:0,ef_ring:1,ef_ellipse:2,ef_firework:3,ef_smoke:4,ef_smokeup:5,ef_star:6,ef_spark:7,ef_flare:8,ef_cloud:9,ef_rain:10,ef_snow:11,fa_readonly:1,fa_hidden:2,fa_sysfile:4,fa_volumeid:8,fa_directory:16,fa_archive:32,fa_left:0,fa_middle:1,fa_right:2,fa_top:0,fa_center:1,fa_bottom:2,self:-1,other:-2,all:-3,noone:-4,global:-5,local:-7,pr_pointlist:1,pr_linelist:2,pr_linestrip:3,pr_trianglelist:4,pr_trianglestrip:5,pr_trianglefan:6,ps_change_all:0,ps_change_motion:2,ps_change_shape:1,ps_deflect_vertical:0,ps_deflect_horizontal:1,ps_distr_linear:0,ps_distr_gaussian:1,ps_distr_invgaussian:2,ps_force_constant:0,ps_force_linear:1,ps_force_quadratic:2,ps_shape_rectangle:0,ps_shape_ellipse:1,ps_shape_diamond:2,ps_shape_line:3,pt_shape_pixel:0,pt_shape_disk:1,pt_shape_square:2,pt_shape_line:3,pt_shape_star:4,pt_shape_circle:5,pt_shape_ring:6,pt_shape_sphere:7,pt_shape_flare:8,pt_shape_spark:9,pt_shape_explosion:10,pt_shape_cloud:11,pt_shape_smoke:12,pt_shape_snow:13,se_none:0,se_chorus:1,se_echo:2,se_flanger:4,se_gargle:8,se_reverb:16,se_compressor:32,se_equalizer:64,ty_real:0,ty_string:1}}}.getList(),i.getTypes().forEach((t=>{this.project.resources[t.name].forEach((t=>{this.globalVars.set(t.name,t.id)}))})),this.drawColor=0,this.drawAlpha=1,this.drawFont=-1,this.drawHAlign=0,this.drawVAlign=0,this.shouldDestroyInstances=[],this.instances=[],this.fps=0,this.fpsFrameCount=0,this.loadFirstRoom(),this.promise=Promise.all(t).then((()=>{console.log("Loaded."),this.initTimeout()})).catch((t=>{this.dealWithException(t)}))}close(t){console.log("Closing game."),this.closeRender(),this.closeInput(),this.closeTimeout(),this.dispatcher.speak("close",t)}initRender(){this.ctx=this.canvas.getContext("2d"),this.ctx.imageSmoothingEnabled=!1,this.project.globalGameSettings.displayCursor||this.canvas.classList.add("no-cursor")}closeRender(){this.canvas.classList.remove("no-cursor")}initInput(){this.key={},this.keyPressed={},this.keyReleased={},this.input.addEventListener("keydown",(t=>{this.key[t.which]=!0,this.keyPressed[t.which]=!0,t.preventDefault()})),this.input.addEventListener("keyup",(t=>{this.key[t.which]=!1,this.keyReleased[t.which]=!0,t.preventDefault()}))}closeInput(){}loadSprites(){var t=[];return this.project.resources.ProjectSprite.forEach((e=>{e.images.forEach(((r,i)=>{t.push(r.promise.catch((t=>{throw new at("Could not load image "+i.toString()+" in sprite "+e.name)})))}))})),Promise.all(t)}initGML(){this.gml=new wt(this),this.preparedCodes=new Map,this.project.resources.ProjectScript.every((t=>this.prepareGML(t.code,t,(e=>{this.throwCompilationErrorInScript(t,e.message)})))),this.project.resources.ProjectObject.every((t=>t.events.every((e=>e.actions.every(((r,i)=>"code"==r.typeKind?this.prepareGML(r.args[0].value,r,(r=>{this.throwErrorInObject(t,e,i,"COMPILATION ERROR in code action:\n"+r.message,!0),console.log(r)})):"normal"!=r.typeKind||"code"!=r.typeExecution||this.prepareGML(r.args[0].value,r,(r=>{this.throwErrorInObject(t,e,i,"COMPILATION ERROR in code action:\n"+r.message+"\n(this was inside the action type in a library)",!0)}))))))))}prepareGML(t,e,r){var i=this.gml.prepare(t);return i.succeeded()?(this.preparedCodes.set(e,i),!0):(r(i),!1)}throwCompilationErrorInScript(t,e){throw this.showErrorBox("\n___________________________________________\nCOMPILATION ERROR in Script: "+t.name+"\n\n"+e+"\n"),new nt}throwErrorInObject(t,e,r,i,s=!1){throw this.showErrorBox("\n___________________________________________\n"+(s?"FATAL ":"")+"ERROR in\naction number "+r.toString()+"\nof "+gt.getEventName(e)+" Event\nfor object "+t.name+":\n\n"+i+"\n"),s?new ct:new ot}throwErrorInCurrent(t,e=!1){var r=this.getResourceById(this.currentInstance.object_index);this.throwErrorInObject(r.name,this.currentEvent,this.currentActionNumber,t,e)}throwErrorInGMLNode(t,e,r=!1){console.log(e);for(var i=e.source.startIdx,s=e.source.sourceString.split("\n"),a=0,n=0;n<s.length;++n){var c=s[n].length+1;if((a+=c)>=i){var o=n+1,u=s[n],l=i-(a-c)+1,_=" ".repeat(l-1)+"^";break}}this.throwErrorInCurrent("Error in code at line "+o+":\n"+u+"\n"+_+"\nat position "+l+": "+t+"\n",r)}loadFirstRoom(){this.room=this.project.resources.ProjectRoom[0],this.loadRoom(this.room)}closeTimeout(){clearTimeout(this.timeout),this.timeout=null,clearInterval(this.fpsTimeout),this.fpsTimeout=null}initTimeout(){null==this.timeout&&(this.timeout=setTimeout((()=>this.mainLoop()),0)),null==this.fpsTimeout&&(this.fpsTimeout=setInterval((()=>this.updateFps()),1e3))}gameEnd(){console.log("Stopping game."),this.closeTimeout(),this.canvas.classList.remove("no-cursor"),this.dispatcher.speak("gameEnd")}drawViews(){this.ctx.fillStyle=this.room.backgroundColor,this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),[...this.instances].sort(((t,e)=>t.vars.get("depth")-e.vars.get("depth"))).forEach((t=>{var e=this.getResourceById("ProjectObject",t.object_index);if(t.vars.get("visible")){var r=e.events.find((t=>"draw"==t.type));if(r)this.doEvent(r,t);else{var i=t.vars.get("sprite_index");if(i>=0){var s=this.getResourceById("ProjectSprite",i);if(s){var a=s.images[t.vars.get("image_index")];a&&(this.ctx.save(),this.ctx.translate(-s.originx,-s.originy),this.ctx.drawImage(a.image,t.vars.get("x"),t.vars.get("y")),this.ctx.restore())}}}}}))}getEventsOfTypeAndSubtype(t,e){var r=this.mapEvents.get(t);return r&&r.get(e)||[]}getEventsOfType(t){var e=this.mapEvents.get(t);return e?[...e.entries()]:[]}mainLoop(){this.timeoutStepStart=performance.now()/1e3,++this.fpsFrameCount,this.mapEvents=this.getMapOfEvents(),this.drawViews(),this.globalVars.setForce("fps",this.fps),this.getEventsOfTypeAndSubtype("step","begin").every((({event:t,instance:e})=>this.doEvent(t,e))),this.getEventsOfType("alarm").every((([t,e])=>e.every((({event:e,instance:r})=>{if(r.vars.get("alarm",[t])>=0&&r.vars.setAdd("alarm",-1,[t]),0==r.vars.get("alarm",[t]))return this.doEvent(e,r)})))),this.getEventsOfType("keyboard").every((([t,e])=>e.every((({event:e,instance:r})=>{if(this.key[t])return this.doEvent(e,r)})))),this.getEventsOfType("keypress").every((([t,e])=>e.every((({event:e,instance:r})=>{if(this.keyPressed[t])return this.doEvent(e,r)})))),this.getEventsOfType("keyrelease").every((([t,e])=>e.every((({event:e,instance:r})=>{if(this.keyReleased[t])return this.doEvent(e,r)})))),this.getEventsOfTypeAndSubtype("step","normal").every((({event:t,instance:e})=>this.doEvent(t,e))),this.instances.forEach((t=>{t.vars.setAdd("x",Math.cos(t.vars.get("direction")*this.constants.pi/180)*t.vars.get("speed")),t.vars.setAdd("y",-Math.sin(t.vars.get("direction")*this.constants.pi/180)*t.vars.get("speed")),t.vars.setAdd("speed",-t.vars.get("friction"))})),this.getEventsOfType("collision").every((([t,e])=>e.every((({event:e,instance:r})=>{this.instances.filter((e=>e.object_index==t)).every((t=>{this.checkCollision(r,t)&&this.doEvent(e,r,t)}))})))),this.getEventsOfTypeAndSubtype("step","end").every((({event:t,instance:e})=>this.doEvent(t,e))),this.keyPressed={},this.keyReleased={},this.shouldDestroyInstances.forEach((t=>{this.instanceDestroy(t)})),this.shouldDestroyInstances=[],this.timeoutStepEnd=performance.now()/1e3,this.timeoutStepTime=this.timeoutStepEnd-this.timeoutStepStart,this.timeoutStepMinTime=1/this.globalVars.get("room_speed"),this.timeoutWaitTime=Math.max(0,this.timeoutStepMinTime-this.timeoutStepTime),this.timeout=setTimeout((()=>this.mainLoop()),1e3*this.timeoutWaitTime),this.timeoutTotalStepTime=this.timeoutStepTime+this.timeoutWaitTime}checkCollision(t,e){var r,i,s=this.getResourceById("ProjectSprite",t.vars.get("sprite_index")),a=s.images[t.vars.get("image_index")],n=this.getResourceById("ProjectSprite",e.vars.get("sprite_index")),c=n.images[e.vars.get("image_index")];return r={x1:t.vars.get("x")-s.originx,y1:t.vars.get("y")-s.originy,x2:t.vars.get("x")-s.originx+a.image.width,y2:t.vars.get("y")-s.originy+a.image.height},i={x1:e.vars.get("x")-n.originx,y1:e.vars.get("y")-n.originy,x2:e.vars.get("x")-n.originx+c.image.width,y2:e.vars.get("y")-n.originy+c.image.height},r.x1<=i.x2&&i.x1<=r.x2&&r.y1<=i.y2&&i.y1<=r.y2}updateFps(){this.fps=this.fpsFrameCount,this.fpsFrameCount=0}loadRoom(t){this.instances=[],this.canvas.width=t.width,this.canvas.height=t.height,this.globalVars.setForce("room_width",t.width),this.globalVars.setForce("room_height",t.height),this.globalVars.setForce("room_speed",t.speed);for(var e=t.instances,r=0;r<e.length;r++)this.instanceCreate(e[r].x,e[r].y,e[r].object_index)}getApplyToInstances(t){switch(t){case-1:return[this.currentInstance];case-2:return[this.currentOther];default:return this.instances.filter((e=>e.object_index==t))}}doEvent(t,e,r=null){return this.currentEvent=t,this.currentInstance=e,this.currentOther=r||e,new bt(t.actions).parse().every((t=>{try{this.doTreeAction(t)}catch(t){if(t instanceof ut)return!1;throw t}return!0}))}doTreeAction(t){if(null!=t.appliesTo)var e=this.getApplyToInstances(t.appliesTo);switch(t.type){case"executeFunction":case"executeCode":{let r=!0;return e.forEach((e=>{var i,s=t.args.map((t=>this.parseActionArg(t)));("number"!=typeof(i="executeFunction"==t.type?this.gml.builtInFunction(t.function,s,e,t.relative):this.gml.execute(this.preparedCodes.get(t.action),e))||i<.5)&&(r=!1)})),r}case"if":this.doTreeAction(t.condition)?this.doTreeAction(t.ifTrue):this.doTreeAction(t.ifFalse);break;case"block":t.actions.forEach((t=>{this.doTreeAction(t)}));break;case"exit":throw new ut;case"repeat":for(var r=this.parseActionArg(t.times),i=0;i<r;i++)this.doTreeAction(t.treeAction);break;case"variable":break;case"code":e.forEach((e=>{this.gml.execute(this.preparedCodes.get(t.action),e)}))}}parseActionArg(t){return"both"==t.kind&&"'"!=t.value[0]&&'"'!=t.value[0]?t.value:"both"==t.kind||"expression"==t.kind?this.gml.executeStringExpression(t.value,this.currentInstance):t.value}showErrorBox(t){this.closeTimeout(),alert(t),this.initTimeout()}instanceCreate(t,e,r){var i=new Et(t,e,r,this);this.instances.push(i);var s=this.getResourceById("ProjectObject",i.object_index).events.find((t=>"create"==t.type));return s&&this.doEvent(s,i),i.vars.get("id")}instanceDestroy(t){var e=this.instances.findIndex((e=>e==t));this.instances.splice(e,1)}getResourceById(t,e){return this.project.resources[t].find((t=>t.id==e))}getMapOfEvents(){var t=new Map;return this.instances.forEach((e=>{this.getResourceById("ProjectObject",e.object_index).events.forEach((r=>{var i=t.get(r.type);null==i&&(i=new Map,t.set(r.type,i));var s=i.get(r.subtype);null==s&&(s=[],i.set(r.subtype,s)),s.push({event:r,instance:e})}))})),t}}class Et{constructor(t,e,r,i){this.object_index=r,this.game=i,this.vars=new mt(this,At),this.vars.setForce("id",100001);var s=i.getResourceById("ProjectObject",this.object_index);this.vars.setForce("object_index",s.id),this.vars.setForce("sprite_index",s.sprite_index),this.vars.setForce("visible",s.visible),this.vars.setForce("solid",s.solid),this.vars.setForce("depth",s.depth),this.vars.setForce("persistent",s.persistent),this.vars.setForce("parent",s.parent),this.vars.setForce("mask",s.mask),this.vars.setForce("x",t),this.vars.setForce("y",e)}}class It{constructor(t,e){this.id=t,this.editor=e,this.html=T(O(N("window","div"))),T(O(N("titlebar","div"))),this.htmlTitle=O(N(null,"span","")),this.htmlCloseButton=O(P("closebutton right","Close",(()=>this.close()))),R(),this.htmlClient=T(O(N("client","div"))),R(),R()}makeClient(t){}makeResourceSelect(t,e,r,i){var s=O(V(t,e)),a={},n=T(s.$("select"));return i||O(B("option",{value:-1},null,"<none>")),this.editor.project.resources[r].forEach((t=>{a[t.id]=O(B("option",{value:t.id},null,t.name))})),R(),this.editor.dispatcher.listen({createResource:t=>{t.constructor.name==r&&(T(n),a[t.id]=O(B("option",{value:t.id},null,t.name)),R())},deleteResource:t=>{t.constructor.name==r&&(M(a[t.id]),delete a[t.id])},changeResourceName:t=>{t.constructor.name==r&&(a[t.id].textContent=t.name)}}),s}makeApplyOkButtons(t,e){T(O(B("div"))),O(P(null,"Apply",(()=>{t()}))),O(P(null,"Ok",(()=>{0!=t()&&e()}))),R()}close(){this.editor.deleteWindow(this)}remove(){M(this.html)}}class St extends It{constructor(...t){super(...t)}makeClient(t){this.htmlTitle.textContent="Edit Sprite "+t.name,T(this.htmlClient),T(O(N("grid-resource resource-sprite","div"))),T(O(N(null,"div")));var e=t.name,r=t.images,i=t.originx,s=t.originy,a=O(L(null,"Name:",e)).$("input");O(P(null,"Load Sprite",(()=>{et.openDialog("image/*").then((t=>{r[0]=new ht(t),l.src=r[0].image.src,r[0].promise.then((()=>{n.textContent=r[0].image.width,c.textContent=r[0].image.height}))}))}))),T(O(N(null,"div","Width: ")));var n=O(N(null,"span","32"));R(),T(O(N(null,"div","Height: ")));var c=O(N(null,"span","32"));R(),t.images.length>0&&t.images[0].promise.then((()=>{n.textContent=t.images[0].image.width,c.textContent=t.images[0].image.height})),T(O(N(null,"fieldset"))),O(N(null,"legend","Origin"));var o=O(G(null,"X:",i,1,0)).$("input"),u=O(G(null,"Y:",s,1,0)).$("input");R(),R(),T(O(N("preview","div")));var l=O(z());t.images.length>0&&(l.src=t.images[0].image.src),R(),R(),this.makeApplyOkButtons((()=>{this.editor.changeResourceName(t,a.value),this.editor.changeSpriteImages(t,r),this.editor.changeSpriteOrigin(t,parseInt(o.value),parseInt(u.value))}),(()=>{this.editor.deleteWindow(this)})),R()}}class jt extends It{constructor(...t){super(...t)}makeClient(t){this.htmlTitle.textContent="Edit Sound "+t.name,T(this.htmlClient),T(O(N("grid-resource resource-sound","div"))),T(O(N(null,"div")));var e=O(L(null,"Name:",t.name)).$("input");O(P(null,"Load Sound",(()=>{et.openDialog("audio/*").then((t=>{}))})));var r=O(G(null,"Volume:",t.volume,"any",0,1)).$("input");R(),R(),this.makeApplyOkButtons((()=>{this.editor.changeResourceName(t,e.value),t.sound=void 0,t.volume=parseFloat(r.value)}),(()=>{this.editor.deleteResourceWindow(t)})),R()}}class Ct extends It{constructor(...t){super(...t)}makeClient(t){this.htmlTitle.textContent="Edit Background "+t.name,T(this.htmlClient),T(O(N("grid-resource resource-background","div"))),T(O(N(null,"div")));var e=t.name,r=t.image,i=O(L(null,"Name:",e)).$("input");O(P(null,"Load Background",(()=>{et.openDialog("image/*").then((t=>{r=new ht(t),n.src=r.image.src,r.promise.then((()=>{s.textContent=r.image.width,a.textContent=r.image.height}))}))}))),T(O(N(null,"div","Width: ")));var s=O(N(null,"span","0"));R(),T(O(N(null,"div","Height: ")));var a=O(N(null,"span","0"));R(),t.image&&t.image.promise.then((()=>{s.textContent=t.image.image.width,a.textContent=t.image.image.height})),R(),T(O(N("preview","div")));var n=O(z());t.image&&(n.src=t.image.image.src),R(),R(),this.makeApplyOkButtons((()=>{this.editor.changeResourceName(t,i.value),this.editor.changeBackgroundImage(t,r)}),(()=>this.editor.deleteWindow(this))),R()}}class Tt extends It{constructor(...t){super(...t)}makeClient(t){this.htmlTitle.textContent="Edit Path "+t.name,T(this.htmlClient),T(O(N("grid-resource resource-path","div"))),T(O(N(null,"div"))),R(),R(),this.makeApplyOkButtons((()=>{}),(()=>this.editor.deleteWindow(this))),R()}}class Rt extends It{constructor(...t){super(...t)}makeClient(t){this.htmlTitle.textContent="Edit Script "+t.name,T(this.htmlClient),T(O(N("grid-resource resource-script","div"))),T(O(N(null,"div")));var e=O(L(null,"Name:",t.name)).$("input");this.textareaCode=O(N("code","textarea",t.code)),R(),R(),this.makeApplyOkButtons((()=>{this.editor.changeResourceName(t,e.value),t.code=this.textareaCode.value}),(()=>{this.editor.deleteWindow(this)})),R()}}class Ot extends It{constructor(...t){super(...t)}makeClient(t){this.htmlTitle.textContent="Edit Font "+t.name,T(this.htmlClient),T(O(N("grid-resource resource-font","div"))),T(O(N(null,"div"))),this.inputName=O(L(null,"Name:",t.name)).$("input"),this.inputFont=O(L(null,"Font:",t.font)).$("input"),this.inputSize=O(G(null,"Size",t.size,1,1)).$("input"),this.inputBold=O(D(null,"Bold",t.bold)).$("input"),this.inputItalic=O(D(null,"Italic",t.italic)).$("input"),this.divPreview=O(N("preview","div","AaBbCcDd")),this.inputFont.oninput=()=>this.updatePreview(),this.inputSize.oninput=()=>this.updatePreview(),this.inputBold.oninput=()=>this.updatePreview(),this.inputItalic.oninput=()=>this.updatePreview(),this.updatePreview(),R(),R(),this.makeApplyOkButtons((()=>{this.editor.changeResourceName(t,this.inputName.value),t.font=this.inputFont.value,t.size=parseInt(this.inputSize.value),t.bold=this.inputBold.checked,t.italic=this.inputItalic.checked}),(()=>this.editor.deleteWindow(this))),R()}updatePreview(){this.divPreview.style.fontFamily=this.inputFont.value,this.divPreview.style.fontSize=this.inputSize.value+"pt",this.divPreview.style.fontWeight=this.inputBold.checked?"bold":null,this.divPreview.style.fontStyle=this.inputItalic.checked?"italic":null}}class Mt extends It{constructor(...t){super(...t)}makeClient(t){this.htmlTitle.textContent="Edit Time Line "+t.name,T(this.htmlClient),T(O(N("grid-resource resource-timeline","div"))),T(O(N(null,"div"))),R(),R(),this.makeApplyOkButtons((()=>{}),(()=>this.editor.deleteWindow(this))),R()}}class Bt extends It{constructor(...t){super(...t)}makeClient(t,e){this.action=t,this.object=e,this.actionType=this.editor.getActionType(t.typeLibrary,t.typeId),this.htmlTitle.textContent=this.actionType.description;var r=this.object.getActionTypeInfo().find((t=>t.kind==this.actionType.kind&&t.interfaceKind==this.actionType.interfaceKind));T(this.htmlClient),O(N(null,"div")),this.actionTypeHasApplyTo=this.actionType.hasApplyTo,null==this.actionType.hasApplyTo&&(this.actionTypeHasApplyTo=r.hasApplyTo),this.actionTypeHasApplyTo,this.actionTypeArgs=this.actionType.args,null==this.actionType.args&&(this.actionTypeArgs=r.args),this.argsInterfaces=[],this.actionTypeArgs.forEach(((e,r)=>{switch(e.kind){case"expression":case"string":case"both":"arrows"==this.actionType.interfaceKind&&0==r?this.argsInterfaces[r]=this.makeDirectionInterface(e.name,t.args[r].value):this.argsInterfaces[r]=this.makeTextInterface(e.name,t.args[r].value);break;case"boolean":this.argsInterfaces[r]=this.makeMenuInterface(e.name,["false","true"],t.args[r].value);break;case"menu":this.argsInterfaces[r]=this.makeMenuInterface(e.name,e.menu,t.args[r].value);break;case"color":this.argsInterfaces[r]=this.makeColorInterface(e.name,t.args[r].value);break;case"sprite":case"background":case"path":case"script":case"object":case"room":case"font":case"timeline":this.argsInterfaces[r]=this.makeResourceInterface(e.name,e.kind,t.args[r].value)}})),this.actionTypeHasRelative=this.actionType.hasRelative,null==this.actionTypeHasRelative&&(this.actionTypeHasRelative=r.hasRelative),this.actionTypeHasRelative&&(this.inputRelative=O(D(null,"Relative",t.relative)).$("input")),this.actionTypeIsQuestion=this.actionType.isQuestion,null==this.actionTypeIsQuestion&&(this.actionTypeIsQuestion=r.isQuestion),this.actionTypeIsQuestion&&(this.inputNot=O(D(null,"NOT",t.not)).$("input")),this.makeApplyOkButtons((()=>{this.apply()}),(()=>{this.close()})),R()}makeTextInterface(t,e){var r=O(L(null,t,e)).$("input");return{getValue:()=>r.value}}makeDirectionInterface(t,e){var r=tt(e),i=["down left","down","down right","left","stop","right","up left","up","up right"],s=[];O(N(null,"span",t)),T(O(N("arrow-interface","div")));for(var a=2;a>=0;--a)for(var n=0;n<=2;++n){var c=3*a+n;s[c]=O(D(null,i[c],r[c])).$("input")}return R(),{getValue:()=>(t=>{for(var e="",r=0;r<9;++r)t[r]?e+="1":e+="0";return e})(s.map((t=>t.checked)))}}makeMenuInterface(t,e,r){var i=e.map(((t,e)=>({name:t,value:e}))),s=O(V(null,t,i)).$("select");return s.selectedIndex=r,{getValue:()=>parseInt(s.value)}}makeColorInterface(t,e){var r=O(U(null,t,H(e))).$("input");return{getValue:()=>H(r.value)}}makeResourceInterface(t,e,r){}apply(){for(var t=0;t<this.action.args.length;t++)this.action.args[t]={kind:this.actionTypeArgs[t].kind,value:this.argsInterfaces[t].getValue()};this.actionTypeHasApplyTo&&(this.action.appliesTo=-1),this.actionTypeHasRelative&&(this.action.relative=this.inputRelative.checked),this.actionTypeIsQuestion&&(this.action.not=this.inputNot.checked)}close(){this.object.deleteActionWindow(this)}}class Nt extends It{constructor(...t){super(...t)}makeClient(t,e){this.action=t,this.object=e,this.actionType=this.editor.getActionType(t.typeLibrary,t.typeId),this.htmlTitle.textContent=this.actionType.description,T(this.htmlClient),O(N(null,"div"));var r="_radio_"+K();this.radioAppliesToSelf=O(W(null,"Self",r,-1==t.appliesTo)).$("input"),this.radioAppliesToOther=O(W(null,"Other",r,-2==t.appliesTo)).$("input"),this.radioAppliesToObject=O(W(null,"Object:",r,t.appliesTo>=0)).$("input"),this.selectObject=this.makeResourceSelect(null,"","ProjectObject").$("select"),t.appliesTo>=0&&(this.selectObject.value=t.appliesTo),this.textareaCode=O(N("code","textarea",t.args[0].value)),this.makeApplyOkButtons((()=>{this.apply()}),(()=>{this.close()})),R()}apply(){this.action.args[0].value=this.textareaCode.value,this.action.appliesTo=this.radioAppliesToSelf.checked?-1:this.radioAppliesToOther.checked?-2:this.radioAppliesToObject.checked?this.selectObject.value:null}close(){this.object.deleteActionWindow(this)}}class Pt extends It{constructor(...t){super(...t)}makeClient(t){this.htmlTitle.textContent="Edit Object "+t.name,this.htmlActionWindows=[],this.paramEvents=t.events.map((t=>{var e=new p(t.type,t.subtype);return e.actions=t.actions.map((t=>{var e=new m;return e.typeLibrary=t.typeLibrary,e.typeId=t.typeId,e.typeKind=t.typeKind,e.typeExecution=t.typeExecution,e.typeExecutionFunction=t.typeExecutionFunction,e.typeExecutionCode=t.typeExecutionCode,e.typeIsQuestion=t.typeIsQuestion,e.args=t.args.map((t=>({kind:t.kind,value:t.value}))),e.appliesTo=t.appliesTo,e.relative=t.relative,e.not=t.not,e})),e})),this.selectEventsOptions={},this.selectActionsOptions={},T(this.htmlClient),T(O(N("grid-resource resource-object","div"))),T(O(N(null,"div")));var e=O(L(null,"Name:",t.name)).$("input"),r=this.makeResourceSelect(null,"Sprite:","ProjectSprite").$("select");r.value=t.sprite_index;var i=O(D(null,"Visible",t.visible)).$("input"),s=O(D(null,"Solid",t.solid)).$("input"),a=O(G(null,"Depth:",t.depth,1)).$("input"),n=O(D(null,"Persistent",t.persistent)).$("input");R(),T(O(N(null,"div"))),this.selectEvents=O(V("events","Events:")).$("select"),this.selectEvents.size=2,this.selectEvents.onchange=()=>{this.updateEventsMenu(),this.updateSelectActions()},this.selectEventType=O(V(null,"Event type:",gt.listEventTypes)).$("select"),this.selectEventType.onchange=()=>this.updateDivEventSubtype(),this.divEventSubtype=O(B("div")),this.buttonEventAdd=O(P(null,"Add event",(()=>{var t=this.selectEventType.value,e=0;if(this.subtypeElement&&(e=this.subtypeElement.value),!this.paramEvents.find((r=>r.type==t&&r.subtype==e))){var r=new p;r.type=t,r.subtype=e,this.paramEvents.push(r),this.sortEvents(),this.selectEvents.value=r.getNameId(),this.updateSelectEvents(),this.updateSelectActions()}}))),this.buttonEventDelete=O(P(null,"Delete event",(()=>{var t=this.paramEvents.findIndex((t=>this.selectEvents.value==t.getNameId()));t<0||this.paramEvents[t].actions.length>0&&!confirm("Are you sure you want to remove the event with all its actions?")||(this.paramEvents.splice(t,1),M(this.selectEventsOptions[this.selectEvents.value]),this.updateEventsMenu(),this.selectActions.textContent="",this.updateActionsMenu())}))),R(),T(O(N(null,"div"))),this.selectActions=O(V("actions","Actions:")).$("select"),this.selectActions.size=2,this.selectActions.onchange=()=>this.updateActionsMenu(),this.buttonActionEdit=O(P(null,"Edit action",(()=>{var t=this.paramEvents.find((t=>this.selectEvents.value==t.getNameId()));if(t){var e=this.selectActions.selectedIndex;if(!(e<0)){var r=t.actions[e];r&&this.openActionWindow(r)}}}))),this.buttonActionDelete=O(P(null,"Delete action",(()=>{var t=this.paramEvents.find((t=>this.selectEvents.value==t.getNameId()));if(t){var e=this.selectActions.selectedIndex;if(!(e<0)){var r=t.actions[e];if(r){var i=this.htmlActionWindows.find((t=>t.id==r));i&&i.close(),t.actions.splice(e,1),this.updateSelectActions(),this.selectActions.selectedIndex=Math.min(e,t.actions.length-1),this.updateActionsMenu()}}}}))),this.buttonActionUp=O(P(null,"",(()=>{var t=this.paramEvents.find((t=>this.selectEvents.value==t.getNameId()));if(t){var e=this.selectActions.selectedIndex;e<0||0==e||(t.actions.splice(e-1,0,t.actions.splice(e,1)[0]),this.updateSelectActions(),this.selectActions.selectedIndex=e-1,this.updateActionsMenu())}}))),this.buttonActionDown=O(P(null,"",(()=>{var t=this.paramEvents.find((t=>this.selectEvents.value==t.getNameId()));if(t){var e=this.selectActions.selectedIndex;e<0||e==t.actions.length-1||(t.actions.splice(e+1,0,t.actions.splice(e,1)[0]),this.updateSelectActions(),this.selectActions.selectedIndex=e+1,this.updateActionsMenu())}}))),R(),T(O(N(null,"div"))),this.editor.libraries.forEach((t=>{T(O(N(null,"fieldset"))),O(N(null,"legend",t.name)),t.items.forEach((e=>{O(P(null,e.description,(()=>{var r=this.paramEvents.find((t=>this.selectEvents.value==t.getNameId()));if(r){var i=new m;i.typeLibrary=t.name,i.typeId=e.id,i.typeKind=e.kind,i.typeExecution=e.execution,i.typeExecutionFunction=e.executionFunction,i.typeExecutionCode=e.executionCode,i.typeIsQuestion=e.isQuestion,i.appliesTo=-1,i.relative=!1,i.not=!1,"normal"==e.kind&&"normal"==e.interfaceKind?i.args=e.args.map((t=>new g(t.kind,t.default))):i.args=this.getActionTypeInfo().find((t=>t.kind==e.kind&&t.interfaceKind==e.interfaceKind)).args.map((t=>new g(t.kind,t.default))),this.openActionWindow(i),r.actions.push(i),this.updateSelectActions(),this.selectActions.selectedIndex=r.actions.length-1,this.updateActionsMenu()}else alert("You need to select or add an event before you can add actions.")}))).title=e.description})),R()})),R(),R(),this.updateSelectEvents(),this.selectEvents.selectedIndex=0,this.updateSelectActions(),this.updateDivEventSubtype(),this.makeApplyOkButtons((()=>{this.editor.changeResourceName(t,e.value),this.editor.changeObjectSprite(t,parseInt(r.value)),t.visible=i.checked,t.solid=s.checked,t.depth=parseInt(a.value),t.persistent=n.checked,this.htmlActionWindows.forEach((t=>{t.apply()})),t.events=this.paramEvents}),(()=>{this.close()})),R()}sortEvents(){this.paramEvents.sort(((t,e)=>{var r=gt.listEventTypes.find((e=>e.value==t.type)).id-gt.listEventTypes.find((t=>t.value==e.type)).id;return 0!=r?r:t.subtype-e.subtype}))}updateSelectEvents(){this.selectEvents.textContent="",this.selectEventsOptions={},T(this.selectEvents),this.paramEvents.forEach((t=>{this.selectEventsOptions[t.getNameId()]=O(B("option",{value:t.getNameId()},null,gt.getEventName(t,this.editor.project)))})),R(),this.updateEventsMenu()}updateEventsMenu(){this.selectEvents.selectedIndex<0?this.buttonEventDelete.disabled=!0:this.buttonEventDelete.disabled=!1}updateDivEventSubtype(){this.divEventSubtype.textContent="";var t=this.selectEventType.value;T(this.divEventSubtype),this.subtypeElement=null,"step"==t?this.subtypeElement=O(V(null,"Step:",Object.keys(gt.listStepSubtypes).map((t=>({value:t,name:gt.listStepSubtypes[t]}))))).$("select"):"alarm"==t?this.subtypeElement=O(G(null,"Alarm:",0,1,0,11)).$("input"):"keyboard"==t||"keypress"==t||"keyrelease"==t?this.subtypeElement=O(G(null,"Key:",0,1,0)).$("input"):"mouse"==t?this.subtypeElement=O(V(null,"Mouse:",Object.keys(gt.listMouseSubtypes).map((t=>({value:t,name:gt.listMouseSubtypes[t]}))))).$("select"):"collision"==t?this.subtypeElement=O(this.makeResourceSelect(null,"Object:","ProjectObject",!0)).$("select"):"other"==t&&(this.subtypeElement=O(V(null,"Other:",Object.keys(gt.listOtherSubtypes).map((t=>({value:t,name:gt.listOtherSubtypes[t]}))))).$("select")),R()}updateSelectActions(){this.selectActions.textContent="";var t=this.paramEvents.find((t=>this.selectEvents.value==t.getNameId()));t&&(T(this.selectActions),t.actions.forEach(((t,e)=>{var r=this.editor.getActionType(t);this.selectActionsOptions[e]=O(B("option",{title:r.getHintText(t)},null,r.getListText(t)))})),R(),this.selectActions.selectedIndex=0),this.updateActionsMenu()}updateActionsMenu(){var t=this.getSelectedEvent();this.selectActions.selectedIndex<0?(this.buttonActionEdit.disabled=!0,this.buttonActionDelete.disabled=!0,this.buttonActionUp.disabled=!0,this.buttonActionDown.disabled=!0):(this.buttonActionEdit.disabled=!1,this.buttonActionDelete.disabled=!1,this.buttonActionUp.disabled=0==this.selectActions.selectedIndex,this.buttonActionDown.disabled=this.selectActions.selectedIndex==t.actions.length-1)}getSelectedEvent(){return this.paramEvents.find((t=>this.selectEvents.value==t.getNameId()))}getActionTypeInfo(){return[{kind:"normal",interfaceKind:"none",args:[]},{kind:"normal",interfaceKind:"normal",htmlclass:Bt},{kind:"normal",interfaceKind:"arrows",htmlclass:Bt,args:[{name:"Directions:",kind:"string",default:"000000000"},{name:"Speed:",kind:"expression",default:"0"}]},{kind:"normal",interfaceKind:"code",htmlclass:Nt,args:[{kind:"string",default:""}]},{kind:"normal",interfaceKind:"text",htmlclass:Nt,args:[{kind:"string",default:""}]},{kind:"repeat",htmlclass:Bt,hasApplyTo:!1,args:[{name:"times:",kind:"expression",default:"1"}]},{kind:"variable",htmlclass:Bt,hasApplyTo:!0,args:[{name:"variable:",kind:"string",default:""},{name:"value:",kind:"expression",default:"0"}]},{kind:"code",htmlclass:Nt,hasApplyTo:!0,args:[{kind:"string",default:""}]},{kind:"begin",args:[]},{kind:"end",args:[]},{kind:"else",args:[]},{kind:"exit",args:[]}]}openActionWindow(t){var e=this.editor.getActionType(t.typeLibrary,t.typeId),r=this.getActionTypeInfo().find((t=>t.kind==e.kind&&t.interfaceKind==e.interfaceKind));if(r.htmlclass){var i=this.editor.openWindow(r.htmlclass,t,t,this);i&&this.htmlActionWindows.push(i)}}deleteActionWindow(t){var e=this.htmlActionWindows.findIndex((e=>e==t));e>=0&&(this.editor.deleteWindow(t),this.htmlActionWindows.splice(e,1))}close(){super.close(),this.htmlActionWindows.forEach((t=>{this.editor.deleteWindow(t)}))}}class Ft extends It{constructor(...t){super(...t)}makeClient(t){this.htmlTitle.textContent="Edit Room "+t.name,T(this.htmlClient),T(O(N("grid-resource resource-room","div"))),T(O(N(null,"div"))),this.paramInstances=t.instances.map((t=>new f(t.x,t.y,t.object_index))),this.inputSnapX=O(G(null,"Snap X:",16,1,1)).$("input"),this.inputSnapY=O(G(null,"Snap Y:",16,1,1)).$("input"),this.inputShowGrid=O(D(null,"Show grid",!0)).$("input"),T(O(N(null,"fieldset"))),O(N(null,"legend","Instances")),this.selectObject=this.makeResourceSelect(null,"Object:","ProjectObject").$("select");var e="_radio_"+K();this.radioAdd=O(W(null,"Add instance",e,!0)).$("input"),this.radioMultiple=O(W(null,"Add multiple instances",e)).$("input"),this.radioMove=O(W(null,"Move instance",e)).$("input"),this.radioDelete=O(W(null,"Delete instance",e)).$("input"),this.inputSnapToGrid=O(D(null,"Snap to grid",!0)).$("input"),this.inputDeleteUnderlying=O(D(null,"Delete underlying",!1)).$("input"),R(),T(O(N(null,"fieldset"))),O(N(null,"legend","Settings")),this.inputName=O(L(null,"Name:",t.name)).$("input"),this.inputWidth=O(G(null,"Width:",t.width,1,1)).$("input"),this.inputHeight=O(G(null,"Height:",t.height,1,1)).$("input"),this.inputSpeed=O(G(null,"Speed:",t.speed,1,1)).$("input"),R(),T(O(N(null,"fieldset"))),O(N(null,"legend","Backgrounds")),this.inputBackgroundColor=O(U(null,"Background color:",t.backgroundColor)).$("input"),R(),T(O(N(null,"div","X: "))),this.spanX=O(N(null,"span","0")),R(),T(O(N(null,"div","Y: "))),this.spanY=O(N(null,"span","0")),R(),T(O(N(null,"div","Object: "))),this.spanObject=O(N(null,"span","")),R(),this.inputWidth.onchange=()=>this.updateCanvasPreview(),this.inputHeight.onchange=()=>this.updateCanvasPreview(),this.inputBackgroundColor.onchange=()=>this.updateCanvasPreview(),this.inputSnapX.onchange=()=>this.updateCanvasPreview(),this.inputSnapY.onchange=()=>this.updateCanvasPreview(),this.inputShowGrid.onchange=()=>this.updateCanvasPreview(),R(),T(O(N("preview","div"))),this.canvasPreview=O(F(null,t.width,t.height)),this.ctx=this.canvasPreview.getContext("2d"),this.ctx.imageSmoothingEnabled=!1,this.canvasPreview.onmousedown=t=>{this.mouseIsDown=!0;var e=this.getMousePosition(t),r=this.snapMousePosition(e);if(this.currentPos=r,this.radioAdd.checked)this.movingInstance=this.addInstance(t);else if(this.radioMultiple.checked)this.movingInstance=this.addInstance(t),this.deleteUnderlying(t);else if(this.radioMove.checked){let t=this.getInstanceAtPosition(e);t&&(this.movingInstance=t)}else if(this.radioDelete.checked){let t=this.getInstanceAtPosition(e);t&&(this.paramInstances=this.paramInstances.filter((e=>e!=t)))}this.updateCanvasPreview()},this.canvasPreview.onmousemove=t=>{var e=this.getMousePosition(t),r=this.snapMousePosition(e);if(this.mouseIsDown){if(this.radioAdd.checked||this.radioMove.checked)this.movingInstance&&(this.movingInstance.x=r.x,this.movingInstance.y=r.y);else if(this.radioMultiple.checked)this.getInstanceAtPosition(e)!=this.movingInstance&&(this.currentPos=r,this.movingInstance=this.addInstance(t),this.deleteUnderlying(t));else if(this.radioDelete.checked){let t=this.getInstanceAtPosition(e);t&&(this.paramInstances=this.paramInstances.filter((e=>e!=t)))}this.updateCanvasPreview()}this.spanX.textContent=r.x,this.spanY.textContent=r.y,this.spanObject.textContent="";{let t=this.getInstanceAtPosition(e);t&&(this.spanObject.textContent=this.editor.project.resources.ProjectObject.find((e=>e.id==t.object_index)).name)}},document.onmouseup=t=>{this.mouseIsDown=!1,this.movingInstance&&this.radioAdd.checked&&this.deleteUnderlying(t),this.movingInstance=null,this.updateCanvasPreview()},R(),R(),this.defaultInstanceImage=new ht("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsIAAA7CARUoSoAAAACoSURBVDhPvZMxDoMwDEVTjsIZundlqMRZK3Xo2r1n4CqUF+IUGycNC08icoj9/a0ol/5xn4NhGp8p0iy5KfqxE6D4NnzSTvN+XXciWUC6looFRECEurgmbDHJ2w9sTnTg2aag9o8YF11rcQk1Qg0rSkxzV+CIo2YHJc4R8OznW2BhU4Kz2nl08E/EIt1BjeCJYH87gs1xHxN4VwnSWXCfM4iQYAtXQvgCVm1gwRwSr8cAAAAASUVORK5CYII="),this.updateCanvasPreview(),this.makeApplyOkButtons((()=>{this.editor.changeResourceName(t,this.inputName.value),t.width=parseInt(this.inputWidth.value),t.height=parseInt(this.inputHeight.value),t.speed=parseInt(this.inputSpeed.value),t.backgroundColor=this.inputBackgroundColor.value,t.instances=this.paramInstances}),(()=>{this.editor.deleteWindow(this)})),R(),this.editor.dispatcher.listen({changeObjectSprite:t=>{this.updateCanvasPreview()},changeSpriteOrigin:t=>{this.updateCanvasPreview()}})}getMousePosition(t){return{x:t.offsetX,y:t.offsetY}}snapMousePosition(t){var e=t.x,r=t.y;return this.inputSnapToGrid.checked&&(e=Math.floor(e/this.inputSnapX.value)*this.inputSnapX.value,r=Math.floor(r/this.inputSnapY.value)*this.inputSnapY.value),{x:e,y:r}}addInstance(t){if(!(this.selectObject.value<0)){var e=new f(this.currentPos.x,this.currentPos.y,this.selectObject.value);return this.paramInstances.push(e),e}}deleteUnderlying(t){if(this.inputDeleteUnderlying.checked)for(var e=this.paramInstances.length-1;e>=0;e--){var r=this.paramInstances[e];r!=this.movingInstance&&this.isInstanceAtPosition(r,this.currentPos)&&this.paramInstances.splice(e,1)}}getInstanceAtPosition(t){for(var e=this.paramInstances.length-1;e>=0;e--){var r=this.paramInstances[e];if(this.isInstanceAtPosition(r,t))return r}return null}isInstanceAtPosition(t,e){var r=this.editor.project.resources.ProjectObject.find((e=>e.id==t.object_index)),i=this.editor.project.resources.ProjectSprite.find((t=>t.id==r.sprite_index)),s=32,a=32,n=0,c=0;i?(n=i.originx,c=i.originy,i.images.length>0&&(s=i.images[0].image.width,a=i.images[0].image.height)):(s=this.defaultInstanceImage.image.width,a=this.defaultInstanceImage.image.height);var o=t.x-n,u=t.y-c,l=o+s,_=u+a;return e.x>=o&&e.x<l&&e.y>=u&&e.y<_}updateCanvasPreview(){if(this.canvasPreview.width=this.inputWidth.value,this.canvasPreview.height=this.inputHeight.value,this.ctx.fillStyle=this.inputBackgroundColor.value,this.ctx.fillRect(0,0,this.canvasPreview.width,this.canvasPreview.height),this.paramInstances.forEach((t=>{var e,r=this.editor.project.resources.ProjectObject.find((e=>e.id==t.object_index)),i=this.editor.project.resources.ProjectSprite.find((t=>t.id==r.sprite_index)),s=0,a=0;if(i){if(s=i.originx,a=i.originy,!(i.images.length>0))return;e=i.images[0]}else e=this.defaultInstanceImage;e.promise.then((()=>{this.ctx.save(),this.ctx.translate(-s,-a),this.ctx.drawImage(e.image,t.x,t.y),this.ctx.restore()}))})),this.inputShowGrid.checked){this.ctx.globalCompositeOperation="difference",this.ctx.fillStyle="white",this.ctx.strokeStyle="white";for(var t=parseInt(this.inputSnapX.value),e=parseInt(this.inputSnapY.value),r=0;r<this.canvasPreview.width;r+=t)this.drawLine(r,0,r,this.canvasPreview.height);for(var i=0;i<this.canvasPreview.height;i+=e)this.drawLine(0,i,this.canvasPreview.width,i);this.ctx.globalCompositeOperation="source-over"}}drawLine(t,e,r,i){this.ctx.save(),this.ctx.translate(.5,.5),this.ctx.beginPath(),this.ctx.moveTo(t,e),this.ctx.lineTo(r,i),this.ctx.stroke(),this.ctx.restore()}}class Lt extends It{constructor(...t){super(...t)}makeClient(t){this.htmlTitle.textContent="Game Information",T(this.htmlClient),this.textareaText=O(N("code","textarea",t.text)),this.makeApplyOkButtons((()=>{t.text=this.textareaText.value}),(()=>this.editor.deleteWindow(this))),R()}}class Gt extends It{constructor(...t){super(...t)}makeClient(t){this.htmlTitle.textContent="Global Game Settings",T(this.htmlClient),this.inputColor=O(U(null,"Color outside the room region:",t.colorOutsideRoom)).$("input"),this.inputDisplayCursor=O(D(null,"Display the cursor",t.displayCursor)).$("input"),this.makeApplyOkButtons((()=>{t.colorOutsideRoom=this.inputColor.value,t.displayCursor=this.inputDisplayCursor.checked}),(()=>this.editor.deleteWindow(this))),R()}}class Dt{constructor(t,e){this.id=t,this.resource=t,this.editor=e,this.html=T(O(N(null,"li"))),this.htmlIcon=O(z("icon")),this.htmlIcon.width=16,this.htmlIcon.height=16,this.editor.setImageSrcRemovable(this.htmlIcon,this.editor.getResourceIconSrc(this.resource)),this.htmlName=O(N("name","span")),this.htmlName.textContent=this.resource.name,T(O(N("right","div"))),this.htmlEditButton=O(P(null,"Edit")),this.htmlDeleteButton=O(P(null,"Delete")),R(),R(),this.editor.dispatcher.listen({changeResourceName:t=>{t===this.resource&&(this.htmlName.textContent=t.name)},changeSpriteImages:e=>{if("ProjectObject"==t.constructor.name){if(e.id!=t.sprite_index)return}else if(e!=this.resource)return;this.editor.setImageSrcRemovable(this.htmlIcon,this.editor.getResourceIconSrc(this.resource))},changeBackgroundImage:t=>{t==this.resource&&this.editor.setImageSrcRemovable(this.htmlIcon,this.editor.getResourceIconSrc(this.resource))},changeObjectSprite:t=>{this.editor.setImageSrcRemovable(this.htmlIcon,this.editor.getResourceIconSrc(this.resource))}})}remove(){M(this.html)}}window.editor=new class{constructor(){this.project=new i,this.game=null,this.projectName="game",this.dispatcher=new E,this.libraries=I.getList(),T(O(B("div",{class:"grid"}))),this.makeMenuArea(),this.makeResourcesArea(),this.makeWindowsArea(),this.makeGameArea(),R(),this.dispatcher.listen({createResource:t=>{this.addResourceToResourcesArea(t),this.openResourceWindow(t)},deleteResource:t=>{this.deleteResourceFromResourcesArea(t),this.deleteResourceWindow(t)}})}createResource(t){var e=new t;return e.id=this.project.counter[t.name],e.name=t.getName()+this.project.counter[t.name],this.project.counter[t.name]++,this.project.resources[t.name].push(e),this.dispatcher.speak("createResource",e),e}deleteResource(t){if(confirm("You are about to delete "+t.name+". This will be permanent. Continue?")){var e=this.project.resources[t.constructor.name].findIndex((e=>e==t));this.project.resources[t.constructor.name].splice(e,1),this.dispatcher.speak("deleteResource",t)}}changeResourceName(t,e){t.name=e,this.dispatcher.speak("changeResourceName",t)}changeSpriteImages(t,e){t.images=e,this.dispatcher.speak("changeSpriteImages",t)}changeSpriteOrigin(t,e,r){t.originx=e,t.originy=r,this.dispatcher.speak("changeSpriteOrigin",t)}changeBackgroundImage(t,e){t.image=e,this.dispatcher.speak("changeBackgroundImage",t)}changeObjectSprite(t,e){t.sprite_index=e,this.dispatcher.speak("changeObjectSprite",t)}makeMenuArea(){T(O(N("menu","div"))),O(P(null,"New",(()=>{confirm("Clear current project and start anew?")&&this.newProject()}))),O(this.newButtonOpenFile(null,"Open",(t=>{this.openProjectFromFile(t)}),"application/zip,application/json")),O(P(null,"Save",(()=>{this.saveProject()}))),this.runButton=O(P(null,"Run",(()=>{this.runGame()}))),this.stopButton=O(P(null,"Stop",(()=>{this.stopGame()}))),this.stopButton.disabled=!0,R()}newButtonOpenFile(t,e,r,i,s=!1){return B("button",{class:t},{click:t=>{et.openDialog(i).then((t=>r(t)))},dragover:t=>{t.preventDefault()},drop:t=>{if(t.preventDefault(),s)r(t.dataTransfer.items.flatMap((t=>"file"!=t.kind?[]:[t.getAsFile()])));else{var e=t.dataTransfer.items[0];null!=e&&"file"==e.kind&&r(e.getAsFile())}}},e)}newProject(){this.project=new i,this.updateResourcesArea(),this.updateWindowsArea()}openProject(){et.openDialog("application/zip,application/json").then((t=>{this.openProjectFromFile(t)}))}openProjectFromFile(t){("application/json"==t.type?et.readEntireFile(t).then((t=>pt.unserializeV1(t))):pt.unserializeZIP(t)).then((e=>{e?(this.project=e,this.updateResourcesArea(),this.updateWindowsArea(),this.projectName=t.name.substring(0,t.name.lastIndexOf("."))):alert("Error Loading: File seems to be corrupt.")}))}saveProject(){pt.serializeZIP(this.project).then((t=>{et.save(t,this.projectName+".zip")}))}runGame(){this.stopGame(),this.project.resources.ProjectRoom.length<=0?alert("A game must have at least one room to run."):(this.runButton.disabled=!0,this.stopButton.disabled=!1,this.gameArea.scrollIntoView(),this.gameCanvas.focus(),this.game=new kt(this.project,j(".canvas"),j(".canvas")),this.game.dispatcher.listen({close:t=>{t instanceof st&&alert("An error has ocurred when trying to run the game:\n"+t.message),this.runButton.disabled=!1,this.stopButton.disabled=!0;var e=this.gameCanvas.height;if(this.gameCanvas.height=0,this.gameCanvas.height=e,t)throw t}}),this.game.init())}stopGame(){this.game&&(this.game.close(),this.game=null)}makeResourcesArea(){this.htmlResources=[],this.htmlResourceTypes={},this.resourcesArea=T(O(B("div",{class:"resources"}))),T(O(N(null,"ul"))),i.getTypes().forEach((t=>{T(O(N(null,"li"))),O(N(null,"span",t.getScreenGroupName())),O(P("right","Create",(()=>{this.createResource(t)}))),this.htmlResourceTypes[t.name]=O(N("resource","ul")),R()})),T(O(N(null,"li"))),O(z("icon","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAPCAIAAABfg7keAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAHOSURBVChTfc/PTxNBFAfwOflnePHiySNe9EDUqx7hoBeMVzVGQwgeBJvIASVReyGeRJqISQmWRRSDUBVbBQq0u4X+bm13cSktZVnazrw369sFLh6cfJM3mXwy7z325G3mnwy9y/nGNLr4fIrjHRdREdJpCcfmstGStUNZtZDee0PmkXORQKcpnIO2bDTlri13LDQaeCnQpHQ+L5BzUZM7VkvuHcroavJyZ8+k8r1Ux2XVoUyE7GO0Ty1sWT3Aq13PGLtx9sporoopEze3IaHDMdq10bSksY/lOgYibU9AchviOqyVT5Bpod7A6JY++CI0Ov5pLBjWDIxXIFaGX8UTVNmTxRqm9Prpi8OM3TpzYXi9Aqu/xc8i/MgLFz1+rRZqmK1i2oSJRY2x3o7uwEqJhFjKi69ZDz16FcvuAI2pGfBycoWx+x1d49GCWMqJcEZ8SXMXPfRHaAtVh40K+N/HGLtzvvvNt5xYzPD5LTG36aG+kXDCgPUyDQE9A9OM9Z06N7KQFp9T/GNSzKheuwdDc7TFcgk+aK1rdxdu+v9cf5rtD+RnNa6ofCru/XRvUKE9IwVBLWiI+RSnFrNJMZ3gUxvt4JqHbvcHqfwvPuUvN/CU7Kb1nFcAAAAASUVORK5CYII=")),O(N("name","span","Game Information")),T(O(N("right","div"))),O(P(null,"Edit",(()=>this.openWindow(Lt,"game-information",this.project.gameInformation)))),R(),R(),T(O(N(null,"li"))),O(z("icon","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAPCAIAAABfg7keAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAGFSURBVChTdZBPKMRREMffb22/ZUN2f1lhDyuJSERuQi5KDjYHpVwcxMXVYcvFSlrJ2cXBSWkPxGFz2xxFm1UibcrfZe36teu3+/vNe2beLnLwml7zZj7znZmnrO7esL9HsdkswyhTVbi+CgRGKYSQEMLkwjBFtsAzBk/l+KsOGF88eAkGDzFrR87iZMAFSIdzgfcxNDKd8eoOtnJkIwjQBN4mOczkZGtd5WjzTbUIEIS9KE0C0iSazd1XatDe6/iGUEZWF9PoP56dD8x5U+Ed9EuQHEW2I5RUO0MTGNd7RtAvQSYoxWmwzuKKubVc9ZaITYZc9R4sJsjK57H6KRbXpprfI/sPd8mWyKau+W6HZ+WIpGSHQgFAmPFTx2e6b8NfcNaoufTJzHad24naIH6UgLn809H1y0T3OBLPbUPq4BjKF/coKVmCZnc3eJJLe/pF9EPzUVoGgSu/SrQX/afItPabbi9tYNHKqEcQKdFe+KbtqIuclwwEyHbKQiDsqaBv/fcw9gUDzCjpiLyE6QAAAABJRU5ErkJggg==")),O(N("name","span","Global Game Settings")),T(O(N("right","div"))),O(P(null,"Edit",(()=>this.openWindow(Gt,"global-game-settings",this.project.globalGameSettings)))),R(),R(),R(),R()}updateResourcesArea(){i.getTypes().forEach((t=>{this.htmlResourceTypes[t.name].textContent="",this.project.resources[t.name].forEach((t=>{this.addResourceToResourcesArea(t)}))}))}addResourceToResourcesArea(t){T(this.htmlResourceTypes[t.constructor.name]);var e=new Dt(t,this);e.htmlEditButton.onclick=()=>this.openResourceWindow(t),e.htmlDeleteButton.onclick=()=>this.deleteResource(t),this.htmlResources.push(e),R()}deleteResourceFromResourcesArea(t){var e=this.htmlResources.findIndex((e=>e.id==t));e>=0&&(this.htmlResources[e].remove(),this.htmlResources.splice(e,1))}getResourceIconSrc(t){if("ProjectSprite"==t.constructor.name){if(t.images.length>0)return t.images[0].image.src}else if("ProjectBackground"==t.constructor.name){if(t.image)return t.image.image.src}else{if("ProjectObject"!=t.constructor.name)return{ProjectFont:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAPCAIAAABfg7keAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAGDSURBVChTdVA9L0NhFH57e31F1dAPxCQWWmKQFDEhMdhIWERCWSq+EsLQpFNFDEaJqYMIsdQgTP0dEiEkGBDx1fa6et8Pz3mvDgYnJyfnPe9znnOe49k6vmZ/zWMY3La9lZXi6jKZHKESQEopRyrbUcWS/LDlqyVf8gL1jdPndPoMvyZwXJILqYROpFSIOdHM8kz6o2zz3CCQgCtEhxLmSPLtrmp4oiUEAIEwi76JQLuG+kPSFxCR7qoySKjCQN/XcsKJRfnCnBwdFrc3mA4+zIXRTljFu5sRwQYzPv4wu57auzAPnj7lW72volB0hsO/TB7e2iaEbjK9E9P9k2PtVxZbnYkM9TaiaPDvb+ykBSq862orYp1BzEKOONjTRCBRKglB4rG7/iBpiDBSoNGaCbK5Mk6OrECTcZjRGssg3UlMXJEKa2r+dWf/fTHFOcvm7j8f8ye5O6wLkOkygd+9OBwNa/GOFeyg6IRlJj3bvYoW4erALOVK9iwls+EaOuu/xtgPyHYaRqqY0EAAAAAASUVORK5CYII=",ProjectPath:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAPCAIAAABfg7keAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAGKSURBVChTdVFBSwJREJ5dZVUQsUIvQtC1iA4dkiCoQ0JdguhW94ogD1ERGwZlhEQHg46e9JAEQkTRoW79hxQjCjqYWpTmsrr73mvmbR06NHy8nTf77ffNzCoH+Qf4G4qq2qbp0jRWLun6NJWQJISwuDAt0erwT5O/G7zeZFjfvKgmk5f41o08mxMYF0wmnAs8b1gEmsADA7B/pRKJIQSeFiVgcUJqyItY7gshgUjoZYyN2CQgwcCV2AjkU/7TVP+w55fEhKSC9+7WPRn9qDWM2IxWvvcVsuj7Q8JWMFCgvaOzlfWurSV/Jt2IJ8ToODaAQY1bTMEHkjSAt9isMhj1PhbtSG91O43TEMlut7EnIsl7cHEOz+rJmZyU5sVQWafDnJ4YvGavW2u7ysRUT3wBhQnyS5WU8NIdDh3veV6eXLWKanwJQSM7PAw3KtkC6pnzYHzeUyqCgLaA58Oc48W4QiRHCe+Vo5ysOtsnDSZo9WRHStIb94QlciFQjr+BSTtlVS+EfbTWfwPgG2gKFdQc39y9AAAAAElFTkSuQmCC",ProjectRoom:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAPCAIAAABfg7keAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAE6SURBVChTdVCxSgNBEJ07j6gg10hsLMTCRgMp/Av/RBAbESXXRsTen7CxEa1sLPyAYCXaiSAiQS/x2NztzPhmF9EIPoa5uZnHe7OTHJ890jSSNPXOzbRa/HBfFFvWAklVG1HX6GctH06GlbyNGP2Di9d+/xLTDDwvFizKoRBR5GtephFJvkFHV6mRGKHIjRXUiMVJdw6xvdoGwUjwsrEJhAjUvC0Li7y+OQuC2TWsK/t3KACNn2/c9jrIpoRVIv4wADgAUSnBuDztWiOgJho6WtsbwB2/qZ9MsFOcRXiiytMYxPBwIOW6Zv4hYTT29FzS07v9/lIKxkAl5gLGS0llZR08E8ig5INQvjNA1ilnWxc5i0o3h5148Xh0+OO8yHFd28muh3uGMbrhpFYbL9glu8X50ryd9V8QfQGGGebPbI0epQAAAABJRU5ErkJggg==",ProjectScript:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAPCAIAAABfg7keAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAGLSURBVChTdZC7SwNBEMbnLsFHoWihjWInAYMGRYkPhIBRIRYiapFOLAQfWCokNoIiKv4HVmIKm1iIESStSEACQRB8ECyj+EASw+Vys+PMnYIWfgzL7M63v5ldbevoAf5K03XLMFwVFXh/G42G5IhNRFRWZJTp01Qfhnorqpc88vnqyfPGxilX3eyzlAQqQjtRinhNYhPkQdV6YTNhmxAODy4E+0vbfQO8ZrMNdxkQE/eaDPcrEgDDHJ6lWNRWX/ljQmpdr5numOs2pgTyo95QL19giYkzvnR8s1/dXrcUXEOl2TwB8yTfpjJquksbn/DE4nsmQWcxKBUA3zCTiBPdKpV4JmYVzJJnsD6W2bmEs64Rv2/Yb9kwMaFpIpJCyhUKuXxBKU0HV/o8xY0kbJJbSLwhei0aT+lS2LsyG4gwgPGIGooH3EyyCKpc7ser97An0mMNXSdTUgFoGfDzI8TkkFhjzfMzgYjzSQywkAf6NRP3Tix8LI7uOl2cmgRyRzFpy9F4Y3WlpP8J4At/fAo9hUkYnAAAAABJRU5ErkJggg==",ProjectSound:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAPCAIAAABfg7keAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAF1SURBVChTfY/bSgJRFIZ7hV6i94jep4sgIuoiaiBvIgi666ogqEAQmzAUI5WykpR0PDUe86zjaZzUvffa09oz401Bmx/WgW+vf62lwyv1l1w3RekijYkkyab1BISBcnNGTYPw0Yz3v3lPB+xveTs2JyAK5pSakzkfTblm8K4OzRGsXU5Rqydl5AQ0JaY+40McMOHtMW+MoDqAmGKirr2GA41nfOVouTeB1hjqQ6j2odiDfAeyLZZqMAfSDECoOYbaACqaILDMtFiywRK1BdTRRRdV0kDtslxblMk6i9fYW2UB1YfCzla2DUqD2flrhT2XqIAOzpVy35n0V+GCBe2dxQtd5ysKLWJVpwyp9OGTCGj3NIpX2N33L1yCRssU80eVBHPUn7Wg7eNQqikgJOwlIqqAAnlyn6F3imW36fKjBXZfyvSpSMNokaeBHPWliawQT9KatLEv451oESlSXCKYJ2jhy9DbFPF8zN0JC1rfcWP4T5L8A8e7ga4+P496AAAAAElFTkSuQmCC",ProjectTimeline:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAPCAIAAABfg7keAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAGpSURBVChTdY/PK0RRFMfvu+bNm/GmicYM+bGgxs8FEUnkR2wmKdnIH2FrMVtStrKzYsWCJBa8xkZSftRk5UcKsdBEPJ438965x7lvTLJwuu92O+9zv+dzlfm1G/a3FM5d2y7y++H6MplMyBZBiOgItB38zIk3W7xYImMC9We2n2dnd+ivjzhXyAUCwTsIgbQbUMVMJsItbG7Xg4AtLqcz7w4r4gQiMlptwKMRva625irNJESzAsXq7UUGVZVTOiKFKShi5YHmDq0AAU5OND083g2PtpaGg68WvL59HRunidEGmkvF6fNUcKi/eW/nxKcwyjk+OO/rbSHCAQnlkxSCGhtrPm1IHV6bH1ZnR31tvJoIMpRJbjZLTnSJOF3XsqYZ0tSSklC+8zMOcjkA+fgPyzGM9HiidaA3buyfWV8OvZq4QhIwx8WV1dTUZE8opPn8amKsa3M9JaG8EyW5yLa2L++fAgtLF5y8Aek+uMGjw9v27rrfJM6VyspwLKZHIsVlZXo0qpdXhDnnpFtIAjY4EidH4cmSH6DiSlEEb5wyndyIBTV5/K8Y+wafFxG5kVwYdQAAAABJRU5ErkJggg=="}[t.constructor.name];if(t.sprite_index>=0){var e=this.project.resources.ProjectSprite.find((e=>e.id==t.sprite_index));if(e&&e.images.length>0)return e.images[0].image.src}}return null}setImageSrcRemovable(t,e){var r,i;r=t,null!=(i=e)?r.setAttribute("src",i):r.removeAttribute("src")}makeWindowsArea(){this.htmlWindows=[],this.htmlWindowsArea=O(B("div",{class:"windows"}))}updateWindowsArea(){this.htmlWindowsArea.textContent="",delete this.htmlWindows,this.htmlWindows=[]}openWindow(t,e,...r){if(this.htmlWindows.find((t=>t.id==e)))return this.focusWindow(e),null;T(this.htmlWindowsArea);var i=new t(e,this);return i.makeClient(...r),R(),this.htmlWindows.unshift(i),this.organizeWindows(),i}openResourceWindow(t){var e={};e[s.name]=St,e[a.name]=jt,e[n.name]=Ct,e[c.name]=Tt,e[u.name]=Rt,e[l.name]=Ot,e[_.name]=Mt,e[h.name]=Pt,e[v.name]=Ft,this.openWindow(e[t.constructor.name],t,t)}focusWindow(t){var e=this.htmlWindows.findIndex((e=>e.id==t));this.htmlWindows.unshift(this.htmlWindows.splice(e,1)[0]),this.organizeWindows()}organizeWindows(){this.htmlWindows.forEach(((t,e)=>{t.html.style.order=e}))}deleteWindow(t){var e=this.htmlWindows.findIndex((e=>e==t));return e>=0&&(this.htmlWindows[e].remove(),this.htmlWindows.splice(e,1),!0)}deleteResourceWindow(t){var e=this.htmlWindows.findIndex((e=>e.id==t));e>=0&&(this.htmlWindows[e].remove(),this.htmlWindows.splice(e,1))}getActionType(...t){var e,r,[i]=t;return i instanceof m?(e=i.typeLibrary,r=i.typeId):[e,r]=t,this.libraries.find((t=>t.name==e)).items.find((t=>t.id==r))}makeGameArea(){this.gameArea=T(O(B("div",{class:"game"}))),this.gameCanvas=O(F("canvas",640,480)),this.gameCanvas.setAttribute("tabindex",0),R()}}}},t=>{t.O(0,[216],(()=>(442,t(t.s=442)))),t.O()}]);